{"datasets":[{"name":"fb4d04ea","displayName":"table_accesses_by_person_and_type","query":"SELECT\n mask(created_by) as created_by,\n entity_type,\n source_type,\n COUNT(distinct event_time) as access_count,\n MIN(event_date) as first_access_date,\n MAX(event_date) as last_access_date\nFROM\n system.access.table_lineage\nWHERE\n source_table_full_name = :table_full_name_val\n AND event_date BETWEEN :start_date AND :end_date\n AND entity_type IS NOT NULL\n AND source_type IS NOT NULL\nGROUP BY\n ALL\nORDER BY\n ALL","parameters":[{"displayName":"start_date","keyword":"start_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-90d/d"}]}}},{"displayName":"end_date","keyword":"end_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}},{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pdavis.po.jobs_with_table_with_date"}]}}}]},{"name":"6cf0a8e9","displayName":"table_accesses_by_date","query":"SELECT\n mask(created_by) as created_by,\n entity_type,\n source_type,\nevent_date,\n COUNT(distinct event_time) as day_access_count\nFROM\n system.access.table_lineage\nWHERE\n source_table_full_name = :table_full_name_val\n AND event_date BETWEEN :start_date AND :end_date\n AND entity_type IS NOT NULL\n AND source_type IS NOT NULL\nGROUP BY\n ALL\nORDER BY\n ALL","parameters":[{"displayName":"start_date","keyword":"start_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-90d/d"}]}}},{"displayName":"end_date","keyword":"end_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}},{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pdavis.po.jobs_with_table_with_date"}]}}}]},{"name":"7e3a8a27","displayName":"related_objects","query":"with downstream AS (\n select\n   distinct target_table_catalog as table_catalog,\n   target_table_schema as table_schema,\n   target_table_name as table_name, \n   'downstream' as direction, \n   CASE WHEN tbl.table_catalog is null then 'no' else 'yes' end as current\n from\n   system.access.table_lineage tl\n   left join system.information_schema.tables tbl \n   on tl.target_table_full_name = concat(tbl.table_catalog, '.', tbl.table_schema, '.', tbl.table_name)\n where\n   source_table_full_name = :table_full_name_val\n   AND target_table_full_name is not null\n  order by current desc, table_catalog, table_schema, table_name\n)\n,\nupstream AS (\n select\n   distinct source_table_catalog as table_catalog,\n   source_table_schema as table_schema,\n   source_table_name as table_name, \n   'upstream' as direction,\n   CASE WHEN tbl.table_catalog is null then 'no' else 'yes' end as current\n from\n   system.access.table_lineage tl\n   left join system.information_schema.tables tbl \n   on tl.source_table_full_name = concat(tbl.table_catalog, '.', tbl.table_schema, '.', tbl.table_name)\n\n where\n   target_table_full_name = :table_full_name_val\n   AND source_table_full_name is not null\n  order by current desc, table_catalog, table_schema, table_name\n)\nselect * from upstream\nUNION ALL\nselect * from downstream","parameters":[{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.billing.usage"}]}}}]},{"name":"b4ac71a5","displayName":"column_usage","query":"WITH column_usage AS (\n    SELECT source_column_name,\n    count(*) as references, \n    Max(event_date) as last_used\n    FROM \n    system.access.column_lineage     \n    WHERE \n    source_table_full_name = :table_full_name_val\n    AND event_date BETWEEN :start_date AND :end_date\n    group by source_column_name\n    ORDER BY references DESC\n)\nselect * from column_usage\n","parameters":[{"displayName":"start_date","keyword":"start_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-14d/d"}]}}},{"displayName":"end_date","keyword":"end_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}},{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.billing.usage"}]}}}]}],"pages":[{"name":"4b8ec5a7","displayName":"New Page","layout":[{"widget":{"name":"75f2e68f","queries":[{"name":"main_query","query":{"datasetName":"fb4d04ea","fields":[{"name":"created_by","expression":"`created_by`"},{"name":"entity_type","expression":"`entity_type`"},{"name":"source_type","expression":"`source_type`"},{"name":"access_count","expression":"`access_count`"},{"name":"first_access_date","expression":"`first_access_date`"},{"name":"last_access_date","expression":"`last_access_date`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"created_by","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"created_by","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"created_by"},{"fieldName":"entity_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100001,"title":"entity_type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"entity_type"},{"fieldName":"source_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100002,"title":"source_type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"source_type"},{"fieldName":"access_count","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":100003,"title":"access_count","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"access_count"},{"fieldName":"first_access_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":100004,"title":"first_access_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"first_access_date"},{"fieldName":"last_access_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":100005,"title":"last_access_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"last_access_date"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"showTitle":true,"title":"Table accesses by Person and Type*","showDescription":false,"description":""}}},"position":{"x":0,"y":8,"width":6,"height":5}},{"widget":{"name":"5e5ef670","queries":[{"name":"main_query","query":{"datasetName":"6cf0a8e9","fields":[{"name":"entity_type","expression":"`entity_type`"},{"name":"daily(event_date)","expression":"DATE_TRUNC(\"DAY\", `event_date`)"},{"name":"sum(day_access_count)","expression":"SUM(`day_access_count`)"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"daily(event_date)","scale":{"type":"temporal"},"displayName":"event_date"},"y":{"fieldName":"sum(day_access_count)","scale":{"type":"quantitative"},"displayName":"Sum of day_access_count"},"color":{"fieldName":"entity_type","scale":{"type":"categorical"},"displayName":"entity_type"},"label":{"show":false}},"frame":{"title":"Table Accesses by Date*","showTitle":true}}},"position":{"x":0,"y":2,"width":3,"height":6}},{"widget":{"name":"259041d3","queries":[{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef38ce00f9115399168140634dac37_table_full_name_val","query":{"datasetName":"fb4d04ea","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_table_full_name_val","query":{"datasetName":"6cf0a8e9","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395c1b1617538fae6533eb6dc11b_table_full_name_val","query":{"datasetName":"7e3a8a27","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef397560211771ae0d80357b6fdf94_table_full_name_val","query":{"datasetName":"b4ac71a5","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef38ce00f9115399168140634dac37_table_full_name_val"},{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_table_full_name_val"},{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395c1b1617538fae6533eb6dc11b_table_full_name_val"},{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef397560211771ae0d80357b6fdf94_table_full_name_val"}]},"frame":{"showTitle":true,"title":"Enter the 3 level table name "},"selection":{"defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.access.table_lineage"}]}}}}},"position":{"x":0,"y":0,"width":2,"height":2}},{"widget":{"name":"c21cd1db","queries":[{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef38ce00f9115399168140634dac37_start_date","query":{"datasetName":"fb4d04ea","parameters":[{"name":"start_date","keyword":"start_date"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_start_date","query":{"datasetName":"6cf0a8e9","parameters":[{"name":"start_date","keyword":"start_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-picker","encodings":{"fields":[{"parameterName":"start_date","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef38ce00f9115399168140634dac37_start_date"},{"parameterName":"start_date","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_start_date"}]},"frame":{"showTitle":true,"title":"Start Date"}}},"position":{"x":2,"y":0,"width":2,"height":2}},{"widget":{"name":"a71bb9d1","queries":[{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_end_date","query":{"datasetName":"6cf0a8e9","parameters":[{"name":"end_date","keyword":"end_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-picker","encodings":{"fields":[{"parameterName":"end_date","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_end_date"}]},"frame":{"showTitle":true,"title":"End Date"}}},"position":{"x":4,"y":0,"width":2,"height":2}},{"widget":{"name":"f2094b41","queries":[{"name":"main_query","query":{"datasetName":"7e3a8a27","fields":[{"name":"table_catalog","expression":"`table_catalog`"},{"name":"table_schema","expression":"`table_schema`"},{"name":"table_name","expression":"`table_name`"},{"name":"entity_type","expression":"`entity_type`"},{"name":"direction","expression":"`direction`"},{"name":"current","expression":"`current`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"table_catalog","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":0,"title":"table_catalog","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"table_catalog"},{"fieldName":"table_schema","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":1,"title":"table_schema","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"table_schema"},{"fieldName":"table_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":2,"title":"table_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"table_name"},{"fieldName":"entity_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":3,"title":"entity_type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"entity_type"},{"fieldName":"direction","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":4,"title":"direction","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"direction"},{"fieldName":"current","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":5,"title":"current","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"current"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"title":"Related Upstream/Downstream Tables, current and deprecated","showTitle":true}}},"position":{"x":0,"y":13,"width":6,"height":4}},{"widget":{"name":"85e0f2c3","textbox_spec":"*Null entity and source types are excluded from this dashboard (e.g. queries from JDBC or UI clicks), comment out those filters to include"},"position":{"x":0,"y":17,"width":6,"height":1}},{"widget":{"name":"e93c1a3b","queries":[{"name":"main_query","query":{"datasetName":"b4ac71a5","fields":[{"name":"source_column_name","expression":"`source_column_name`"},{"name":"references","expression":"`references`"},{"name":"last_used","expression":"`last_used`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"source_column_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"source_column_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"source_column_name"},{"fieldName":"references","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":100001,"title":"references","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"references"},{"fieldName":"last_used","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":100002,"title":"last_used","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"last_used"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"showTitle":true,"title":"Column usage","showDescription":false}}},"position":{"x":3,"y":2,"width":3,"height":6}}]}]}