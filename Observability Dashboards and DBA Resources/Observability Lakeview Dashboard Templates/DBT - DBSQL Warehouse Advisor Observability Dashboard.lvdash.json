{
  "datasets": [
    {
      "name": "4bf19021",
      "displayName": "Query Statement Resource Attribution",
      "query": "WITH history AS (\nSELECT\nstatement_id,\nexecuted_by,\nstatement_text,\nwarehouse_id,\nexecution_status,\nf.statement_type,\nclient_application,\nCOALESCE(error_message, 'None') AS error_message,\ntry_divide(total_duration_ms, 1000) AS QueryRuntimeSeconds,\ntry_divide(total_task_duration_ms, 1000) AS CPUTotalExecutionTime,\ntry_divide(execution_duration_ms, 1000) AS ExecutionQueryTime,\ntry_divide(compilation_duration_ms, 1000) AS CompilationQueryTime,\ntry_divide(waiting_at_capacity_duration_ms, 1000) AS QueueQueryTime,\ntry_divide(waiting_for_compute_duration_ms, 1000) AS StartUpQueryTime,\ntry_divide(result_fetch_duration_ms, 1000) AS ResultFetchTime,\nstart_time,\nend_time,\nCOALESCE(total_task_duration_ms / execution_duration_ms, NULL) AS TotalCPUTime_To_Execution_Time_Ratio,\nCOALESCE(waiting_at_capacity_duration_ms / total_duration_ms, 0) AS ProportionQueueTime,\nAVG(COALESCE(total_task_duration_ms / execution_duration_ms, NULL)) OVER () AS AvgTaskSkewRatio,\nAVG(try_divide(total_duration_ms, 1000))  OVER () AS AvgQueryRuntime,\nAVG(try_divide(waiting_at_capacity_duration_ms, 1000)) OVER () AS AvgQueueTime,\nAVG(COALESCE(try_divide(waiting_at_capacity_duration_ms, 1000) / try_divide(total_duration_ms, 1000), 0)) OVER () AS AvgProportionTimeQueueing,\nSUM(try_divide(total_duration_ms, 1000)) OVER () AS TotalUsedTimeInWarehouse,\nSUM(try_divide(total_duration_ms, 1000)) OVER (PARTITION BY statement_text) AS TotalStatementTextTimeUsed, -- for query level aggregates\ntry_divide(try_divide(total_duration_ms, 1000) , TotalUsedTimeInWarehouse) AS ProportionOfWarehouseTimeUsedByQuery ,\n-- Can use this to chargeback (as long as you know denominator is only USED task time, not including idele time)\n-- DBT Info \nsubstr(statement_text, INSTR(statement_text, '/*') + 2, INSTR(statement_text, '*/') - INSTR(statement_text, '/*') - 2) AS dbt_metadata_json\nFROM system.query.history f\nWHERE warehouse_id = :warehouse_id\nAND (start_time >= :start_time AND end_time <= :end_time) -- Must pushdown these filters for accurate % aggregates by warehouse\nAND total_duration_ms > 0\nAND statement_type IS NOT NULL\n),\n\n-- Warehosue Costs for the same query window \nfiltered_warehouse_usage AS (\n        -- This is to properly handle attributing partial hours/seconds and match it to the seleted query window\n\n        WITH trimmed_usage AS (\n        SELECT \n        -- Start Time Range Trimming\n        timestampdiff(SECOND, usage_start_time, :start_time)::float AS seconds_before_start_range,\n        timestampdiff(SECOND, usage_start_time, usage_end_time)::float AS full_start_range_length,\n        full_start_range_length - seconds_before_start_range AS seconds_remaining_in_original_start_range,\n        greatest(:start_time, usage_start_time) AS trimmed_start_time,\n        -- End Time Range Trimming\n        least(:end_time, usage_end_time) AS trimmed_end_time,\n        timestampdiff(SECOND, :end_time, usage_end_time)::float AS seconds_after_end_range,\n        timestampdiff(SECOND, usage_start_time, usage_end_time)::float AS full_end_range_length,\n        full_end_range_length - seconds_after_end_range AS seconds_remaining_in_original_end_range,\n\n        -- Calculate trim proportion to multiple DBUs by proportion of the full hour in the active window\n        try_divide(CASE WHEN seconds_before_start_range > 0 THEN (full_start_range_length - seconds_before_start_range) ELSE NULL END, full_start_range_length) AS StartTrimProportion,\n        try_divide(CASE WHEN seconds_after_end_range > 0 THEN (full_start_range_length - seconds_after_end_range) ELSE NULL END, full_start_range_length) AS EndTrimProportion,\n        COALESCE(COALESCE(EndTrimProportion, StartTrimProportion), 1) AS TrimProportion,\n        usage_start_time,\n        usage_end_time,\n        usage_quantity AS dbus,\n        usage_metadata.warehouse_id AS warehouse_id\n        FROM system.billing.usage\n        WHERE usage_metadata.warehouse_id = :warehouse_id\n        AND usage_unit = 'DBU'\n        AND (\n        (usage_start_time BETWEEN :start_time::timestamp AND :end_time::timestamp)\n        OR (usage_end_time BETWEEN :start_time::timestamp AND :end_time::timestamp)\n        )\n        )\n\n        SELECT \n        warehouse_id,\n        SUM(dbus*TrimProportion) AS Total_Warehouse_Period_DBUs,\n        SUM(dbus*TrimProportion*:cluster_unit_price::float) AS Total_Warehouse_Period_Dollars\n        FROM trimmed_usage\n        GROUP BY warehouse_id\n),\n\nhistory_with_pricing AS (\nSELECT \nh1.*,\nwh.Total_Warehouse_Period_DBUs, \nwh.Total_Warehouse_Period_Dollars,\n\n-- DBT Metadata Attributions\nCOALESCE(dbt_metadata_json:app, 'None') AS app,\nCOALESCE(dbt_metadata_json:node_id, 'None') AS node_id,\nCOALESCE(dbt_metadata_json:profile_name, 'None') AS profile_name,\nCOALESCE(dbt_metadata_json:target_name, 'None') AS target_name,\nCOALESCE(dbt_metadata_json:dbt_version, 'None') AS dbt_version,\nCOALESCE(dbt_metadata_json:dbt_databricks_version, 'None') AS dbt_databricks_version,\ndbt_metadata_json,\nfrom_json(dbt_metadata_json, 'map<string,string>') AS parsed_dbt_comment,\nCASE WHEN (lower(dbt_metadata_json:app) = \"dbt\" OR client_application LIKE ('%dbt%')) THEN 'DBT Query' ELSE 'Other Query Type' END AS DBT_Query_Type\nFROM history AS h1\nLEFT JOIN filtered_warehouse_usage AS wh ON h1.warehouse_id = wh.warehouse_id\n),\n\n\nquery_proportion_agg AS (\n-- Cumulative Sum by statement_text (not query id, but distinct statement)\nSELECT \n-- We do this to \nsha2(regexp_replace(regexp_replace(REGEXP_REPLACE(statement_text, '/\\\\*.*?\\\\*/', ''), '(--[^\\\\n]*)', ''), ' ', ''), 256) AS query_signature,\nMAX(statement_text) AS statement_text,\nCOUNT(statement_id) AS NumberOfExecutions,\nAVG(QueryRuntimeSeconds) AS AvgRuntimeInSeconds,\nMAX(TotalUsedTimeInWarehouse) AS TotalWarehouseTimeUsed,\nMAX(Total_Warehouse_Period_DBUs) AS Total_Warehouse_Period_DBUs,\nMAX(Total_Warehouse_Period_Dollars) AS Total_Warehouse_Period_Dollars,\nSUM(QueryRuntimeSeconds) AS TotalStatementTimeUsed,\nMAX(app) AS app,\nMAX(node_id) AS node_id,\nMAX(profile_name) AS profile_name,\nMAX(target_name) AS target_name,\nMAX(dbt_version) AS dbt_version,\nMAX(dbt_databricks_version) AS dbt_databricks_version,\nMAX(dbt_metadata_json) AS dbt_metadata_json,\nFIRST(parsed_dbt_comment) AS parsed_dbt_comment,\nMAX(DBT_Query_Type) AS DBT_Query_Type,\nARRAY_DISTINCT(COLLECT_LIST(NAMED_STRUCT('status', execution_status, 'error_message', error_message, 'execution_count', (SELECT COUNT(statement_id) FROM history AS in_hist WHERE in_hist.execution_status = u.execution_status AND in_hist.error_message = u.error_message  AND in_hist.statement_text = u.statement_text)))) AS StatusErrorCounts,\nARRAY_DISTINCT(COLLECT_LIST(NAMED_STRUCT('user', executed_by, 'execution_count', (SELECT COUNT(statement_id) FROM history AS in_hist WHERE in_hist.executed_by = u.executed_by AND in_hist.statement_text = u.statement_text)))) AS UserRunCounts\nFROM history_with_pricing AS u\nWHERE \n-- DBT Dynamic Tag Parsing\n(CASE WHEN ((length(:Selected_DBT_Key) > 1) AND (lower(:Selected_DBT_Key) != 'none')) THEN parsed_dbt_comment[:Selected_DBT_Key] IS NOT NULL\nWHEN (lower(:Selected_DBT_Key) = 'none') THEN 1=1\nELSE 1=0 END)\nGROUP BY query_signature\n),\n\nstatement_attribution AS (\nSELECT \na.*,\ntry_divide(TotalStatementTimeUsed, TotalWarehouseTimeUsed) AS StatementTaskTimeProportion,\nTotal_Warehouse_Period_Dollars*StatementTaskTimeProportion AS StatementAllocatedDollars,\nTotal_Warehouse_Period_DBUs*StatementTaskTimeProportion AS StatementAllocatedDBUs\nFROM query_proportion_agg a\n),\n\nstatement_rollup_cumulative_sum AS (\n    SELECT \n    *,\n    parsed_dbt_comment[:Selected_DBT_Key] AS Selected_DBT_Key,\n    SUM(StatementTaskTimeProportion) OVER (ORDER BY StatementTaskTimeProportion DESC) AS CumulativeProportionOfWarehouseTime\n    FROM statement_attribution\n)\n\nSELECT \ns.*,\nStatementTaskTimeProportion*100 AS StatementWarehouseTimePercentage,\nCASE WHEN s.CumulativeProportionOfWarehouseTime <= :query_pareto::float THEN s.statement_text ELSE 'Remaining Long Tail of Queries' END AS QueryProportionParetoFlag\nFROM statement_rollup_cumulative_sum s\nORDER BY CumulativeProportionOfWarehouseTime",
      "parameters": [
        {
          "displayName": "warehouse_id",
          "keyword": "warehouse_id",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "475b94ddc7cd5211"
                }
              ]
            }
          }
        },
        {
          "displayName": "start_time",
          "keyword": "start_time",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "2024-03-18T09:31:18.000Z"
                }
              ]
            }
          }
        },
        {
          "displayName": "end_time",
          "keyword": "end_time",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "2024-03-26T09:31:22.000Z"
                }
              ]
            }
          }
        },
        {
          "displayName": "cluster_unit_price",
          "keyword": "cluster_unit_price",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "0.7"
                }
              ]
            }
          }
        },
        {
          "displayName": "Selected_DBT_Key",
          "keyword": "Selected_DBT_Key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "None"
                }
              ]
            }
          }
        },
        {
          "displayName": "query_pareto",
          "keyword": "query_pareto",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "0.5"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "84491e8e",
      "displayName": "Cluster Scaling",
      "query": "WITH raw_scaling AS (\nSELECT \ndate_trunc('MINUTE', event_time) AS event_minute,\nMAX(w.cluster_count) AS clusters\nFROM system.compute.warehouse_events w\nWHERE warehouse_id = :warehouse_id\nAND event_type IN (\"RUNNING\", \"SCALED_UP\", \"SCALED_DOWN\", \"STOPPED\")\nGROUP BY date_trunc('MINUTE', event_time)\nORDER BY event_minute\n),\n\nfull_series AS (\nSELECT explode(sequence((SELECT MIN(event_minute) FROM raw_scaling), (SELECT MAX(event_minute) FROM raw_scaling), INTERVAL 1 MINUTE)) AS minuteChunk\n),\n\nfilled_in_series AS (\nSELECT \nspine.minuteChunk AS event_minute,\nMAX(s2.clusters) AS NumberOfClustersOn\nFROM full_series AS spine\nLEFT JOIN raw_scaling AS s2 ON\n date_trunc('minute', s2.event_minute) = spine.minuteChunk --already aggregated at minute rounded level\nGROUP BY \nspine.minuteChunk\nORDER BY event_minute \n)\n\nSELECT event_minute,\nLAST_VALUE(NumberOfClustersOn, true) OVER (ORDER BY event_minute) AS NumberOfClustersOn\n FROM filled_in_series ORDER BY event_minute",
      "parameters": [
        {
          "displayName": "warehouse_id",
          "keyword": "warehouse_id",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "475b94ddc7cd5211"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "9275d56b",
      "displayName": "Query History With Ratios",
      "query": "/*\n-- DBT Version - Parses out common DBT tags and allows for dynamic search of a tag key\nTO DO: \n-- Make execution_type, execution_status parameters once multi-valued params comes out so all calculations downstream are dynamic\n\n\n*/\nWITH history AS (\nSELECT\nstatement_id,\nexecuted_by,\nstatement_text,\nwarehouse_id,\nexecution_status,\nf.statement_type,\nclient_application,\nCOALESCE(error_message, 'None') AS error_message,\nCOALESCE(try_divide(total_duration_ms, 1000), 0) AS QueryRuntimeSeconds,\nCOALESCE(try_divide(total_task_duration_ms, 1000), 0) AS CPUTotalExecutionTime,\nCOALESCE(try_divide(execution_duration_ms, 1000), 0) AS ExecutionQueryTime,\nCOALESCE(try_divide(compilation_duration_ms, 1000), 0) AS CompilationQueryTime,\nCOALESCE(try_divide(waiting_at_capacity_duration_ms, 1000), 0) AS QueueQueryTime,\nCOALESCE(try_divide(waiting_for_compute_duration_ms, 1000), 0) AS StartUpQueryTime,\nCOALESCE(try_divide(result_fetch_duration_ms, 1000), 0) AS ResultFetchTime,\nstart_time,\nend_time,\nupdate_time,\nCOALESCE(read_bytes, 0) AS read_bytes,\nCOALESCE(read_io_cache_percent, 0) AS read_io_cache_percent,\nfrom_result_cache,\nCOALESCE(spilled_local_bytes, 0) AS spilled_local_bytes,\nCOALESCE(total_task_duration_ms / total_duration_ms, NULL) AS TotalCPUTime_To_Execution_Time_Ratio, --execution time does seem to vary across query type, using total time to standardize\nCOALESCE(waiting_at_capacity_duration_ms / total_duration_ms, 0) AS ProportionQueueTime,\nAVG(try_divide(total_duration_ms, 1000))  OVER () AS WarehouseAvgQueryRuntime,\nAVG(try_divide(waiting_at_capacity_duration_ms, 1000)) OVER () AS WarehouseAvgQueueTime,\nAVG(COALESCE(try_divide(waiting_at_capacity_duration_ms, 1000) / try_divide(total_duration_ms, 1000), 0)) OVER () AS WarehouseAvgProportionTimeQueueing,\nSUM(try_divide(total_duration_ms, 1000)) OVER () AS TotalUsedTimeInWarehouse,\nSUM(try_divide(total_duration_ms, 1000)) OVER (PARTITION BY statement_text) AS TotalStatementTextTimeUsed, -- for query level aggregates\ntry_divide(try_divide(total_duration_ms, 1000) , TotalUsedTimeInWarehouse) AS ProportionOfWarehouseTimeUsedByQuery ,\n-- Can use this to chargeback (as long as you know denominator is only USED task time, not including idele time)\nCASE WHEN read_bytes > 0 THEN try_divide(read_bytes,(1024*1024*1024))ELSE 0 END AS ReadDataAmountInGB,\nCASE WHEN read_io_cache_percent > 0 THEN 'Used Cache' ELSE 'No Cache' END AS UsedCacheFlag,\nCASE WHEN spilled_local_bytes > 0 THEN 'Spilled Data To Disk' ELSE 'No Spill' END AS HasSpillFlag,\nCASE WHEN read_bytes > 0 THEN 'Did Read Data' ELSE 'No Data Read' END AS ReadDataFlag,\nCASE WHEN CPUTotalExecutionTime > 0 THEN 'UsedWorkerTasks' ELSE 'NoWorkers' END AS UsedWorkerTasksFlag,\nCASE WHEN QueryRuntimeSeconds >= :long_running_seconds_treshold::float THEN 'Long Running' ELSE 'Short Running' END AS LongRunningQueryFlag,\nCASE WHEN spilled_local_bytes > 0 THEN 1 ELSE 0 END AS Calc_HasSpillFlag,\nCASE WHEN read_bytes > 0 THEN 0.25 ELSE 0 END AS Calc_ReadDataFlag,\nCASE WHEN CPUTotalExecutionTime > 0 THEN 0.25 ELSE 0 END AS Calc_UsedWorkerTasksFlag,\nCASE WHEN QueryRuntimeSeconds >= :long_running_seconds_treshold::float THEN 1 ELSE 0 END AS Calc_LongRunningQueryFlag,\nsubstr(statement_text, INSTR(statement_text, '/*') + 2, INSTR(statement_text, '*/') - INSTR(statement_text, '/*') - 2) AS dbt_metadata_json\nFROM system.query.history f\nWHERE warehouse_id = :warehouse_id\nAND start_time BETWEEN :start_range::timestamp AND :end_range::timestamp -- TO DO: this technically does not line up with \nAND statement_type IS NOT NULL\n),\n\n-- Warehosue Costs for the same query window \nfiltered_warehouse_usage AS (\n        -- This is to properly handle attributing partial hours/seconds and match it to the seleted query window\n\n        WITH trimmed_usage AS (\n        SELECT \n        -- Start Time Range Trimming\n        timestampdiff(SECOND, usage_start_time, :start_range)::float AS seconds_before_start_range,\n        timestampdiff(SECOND, usage_start_time, usage_end_time)::float AS full_start_range_length,\n        full_start_range_length - seconds_before_start_range AS seconds_remaining_in_original_start_range,\n        greatest(:start_range, usage_start_time) AS trimmed_start_time,\n        -- End Time Range Trimming\n        least(:end_range, usage_end_time) AS trimmed_end_time,\n        timestampdiff(SECOND, :end_range, usage_end_time)::float AS seconds_after_end_range,\n        timestampdiff(SECOND, usage_start_time, usage_end_time)::float AS full_end_range_length,\n        full_end_range_length - seconds_after_end_range AS seconds_remaining_in_original_end_range,\n\n        -- Calculate trim proportion to multiple DBUs by proportion of the full hour in the active window\n        try_divide(CASE WHEN seconds_before_start_range > 0 THEN (full_start_range_length - seconds_before_start_range) ELSE NULL END, full_start_range_length) AS StartTrimProportion,\n        try_divide(CASE WHEN seconds_after_end_range > 0 THEN (full_start_range_length - seconds_after_end_range) ELSE NULL END, full_start_range_length) AS EndTrimProportion,\n        COALESCE(COALESCE(EndTrimProportion, StartTrimProportion), 1) AS TrimProportion,\n        usage_start_time,\n        usage_end_time,\n        usage_quantity AS dbus,\n        usage_metadata.warehouse_id AS warehouse_id\n        FROM system.billing.usage\n        WHERE usage_metadata.warehouse_id = :warehouse_id\n        AND usage_unit = 'DBU'\n        AND (\n        (usage_start_time BETWEEN :start_range::timestamp AND :end_range::timestamp)\n        OR (usage_end_time BETWEEN :start_range::timestamp AND :end_range::timestamp)\n        )\n        )\n\n        SELECT \n        warehouse_id,\n        SUM(dbus*TrimProportion) AS Total_Warehouse_Period_DBUs,\n        SUM(dbus*TrimProportion*:cluster_unit_price::float) AS Total_Warehouse_Period_Dollars\n        FROM trimmed_usage\n        GROUP BY warehouse_id\n),\n\n\n/*\nWAREHOUSE LEVEL SKEW / EFFICIENCY METRICS\n-- Calculate the warehouse average task times to execution time to get a basedline to compare relative skew/efficiency across warehouse\nNOTE: We do this because we do not yet have the \"warehouses\" table, which would give us the size/rough cores of the cluster, \nso we do NOT programmatically have the ability to know what a proper ratio is. If we knew the number of cores on the cluster, our skew ratio would look like this: \n\nSKEW RATIO = (TotalQueryTaskTime / NumberOfCores) / ExecutionTime = 1 in a perfect/avg scenario. This means that ALL cores were perfectly fully utilize during the entire execution\nRatio ~1 means that there is lots of paralleliszation (high tasks time per unit of time).\nRatio < 1 means that the exeuction time was not fully filled by task time across all cores. The smaller this number is, the more likely it is to be skewed. \nShould never really have a ratio > 1 (that would mean there were more total task time than cores could theoretically processs) when we KNOW the number of cores. \n-- Is the query getting the warehouse fully?\n-- Good ratio (is .5 reasonable?)\n-- Closer to zero is a problem (<0.05) -- only matters when queyies are large (filter num tasks / cores)\n\nNow since we do NOTE automatically know the number of cores, we have to make this ratio relative and create a PROXY metric. \nTo do that, we will take the average ratio of Total Task Time / Execution Time across the whole warehouse for ALL queries that had task time (exclude metadata operations)\nIdeal Ratio = 1 = ((Task Time)/ Cores ) / Execution Time\nSo Execution Time = Task Time / Cores\nSo Cores = Task Time / Execution Time in a perfect / avg scenario. \n\nThis is NOT perfect, but helps as a proxy for now. Since this metric is to identify relatively inefficient/skewed queryes, it should work well enough. \n\n*/\n\nwarehouse_average_ratio_metrics AS (\nSELECT \nwarehouse_id,\ntry_divide(AVG(CPUTotalExecutionTime)::float, AVG(QueryRuntimeSeconds)::float)::float AS WarehouseAvgTaskSkewRatio,\ntry_divide(MAX(CPUTotalExecutionTime), MAX(QueryRuntimeSeconds))::float AS WarehouseMaxTaskSkewRatio,\nAVG(ReadDataAmountInGB)::float AS WarehouseAvgReadDataInGBPerQuery,\nstddev(ReadDataAmountInGB)::float AS WarehouseStdReadDataInGBPerQuery,\nAVG(read_io_cache_percent)::float AS WarehouseAvgDeltaCachePercent,\nstddev(read_io_cache_percent)::float AS WarehouseStdDeltaCachePercent,\nAVG(spilled_local_bytes)::float AS WarehouseAvgDiskSpillAmount,\nstddev(spilled_local_bytes)::float AS WarehouseStdDiskSpillAmount\nFROM history\nWHERE CPUTotalExecutionTime > 0 AND ReadDataAmountInGB > 0 -- Means that the query read data as well as used cpu task time in workers\nAND execution_status NOT IN (\"FAILED\")\nGROUP BY warehouse_id\n),\n\n-- Single Metric to indicate an inefficient query\n/*\nInefficient query attributes: \n1. Long runtime (> X number of seconds/minutes)\n2. Poor Parallelization (high wall clock time with low task time compared to ratio of all warehouse)\n3. Spilling To Disk\n4. Lots of Data Read (Compared to Avg Data Read for Warehouse) - Using Z Score as a rough metric for this\n\nPrecursor filters\n1. Query must have task time > 0 (meaning workers were actually used to execute the query) (this filters out non sparky stuff like GRANT/ALTER/metadata)\n2. Must have data read in (>0 GB)\n*/\n\nquery_level_intel_metrics AS (\nSELECT qh.*,\nw.WarehouseAvgTaskSkewRatio AS WarehouseAvgTaskToExecutionTimeRatio,\n\n-- For the query efficiency ratio, we invert the above ratio to use the warehouse proxy metric\nCASE WHEN CPUTotalExecutionTime > 0 \n        AND ReadDataAmountInGB > 0 -- Means that the query read data as well as used cpu task time in workers\n        AND execution_status NOT IN (\"FAILED\")\n    THEN try_divide(QueryRuntimeSeconds, try_divide(qh.CPUTotalExecutionTime, w.WarehouseAvgTaskSkewRatio))\n    ELSE NULL\n    END AS QueryEfficiencyRatio,  -- WarehouseSkewRatio is the proxy for number of cores/level of parallelism in the cluster\nw.WarehouseAvgReadDataInGBPerQuery,\nw.WarehouseStdReadDataInGBPerQuery,\nw.WarehouseAvgDeltaCachePercent,\nw.WarehouseStdDeltaCachePercent,\nw.WarehouseAvgDiskSpillAmount,\nw.WarehouseStdDiskSpillAmount,\nu.Total_Warehouse_Period_Dollars,\n(u.Total_Warehouse_Period_Dollars::float*ProportionOfWarehouseTimeUsedByQuery::float) AS AllocatedQueryCostByTime,\n-- DBT Metadata Attributions\nCOALESCE(dbt_metadata_json:app, 'None') AS app,\nCOALESCE(dbt_metadata_json:node_id, 'None') AS node_id,\nCOALESCE(dbt_metadata_json:profile_name, 'None') AS profile_name,\nCOALESCE(dbt_metadata_json:target_name, 'None') AS target_name,\nCOALESCE(dbt_metadata_json:dbt_version, 'None') AS dbt_version,\nCOALESCE(dbt_metadata_json:dbt_databricks_version, 'None') AS dbt_databricks_version,\ndbt_metadata_json,\nfrom_json(dbt_metadata_json, 'map<string,string>') AS parsed_dbt_comment,\nCASE WHEN (lower(dbt_metadata_json:app) = \"dbt\" OR client_application LIKE ('%dbt%')) THEN 'DBT Query' ELSE 'Other Query Type' END AS DBT_Query_Type\nFROM history AS qh\nLEFT JOIN warehouse_average_ratio_metrics AS w ON w.warehouse_id = qh.warehouse_id\nLEFT JOIN filtered_warehouse_usage AS u ON u.warehouse_id = qh.warehouse_id\n),\n\n-- Calculate Z Score for warehouse read data and other metrics\nzscores AS (\nSELECT \n*,\nAVG(QueryEfficiencyRatio) OVER () AS WarehouseAvgQueryEfficiencyRatio,\ntry_divide((spilled_local_bytes - WarehouseAvgDiskSpillAmount) , WarehouseStdDiskSpillAmount) AS SpillAmountZScore,\ntry_divide((read_io_cache_percent - WarehouseAvgDeltaCachePercent), WarehouseStdDeltaCachePercent) AS CachePercentZScore,\ntry_divide((ReadDataAmountInGB - WarehouseAvgReadDataInGBPerQuery), WarehouseStdReadDataInGBPerQuery) AS DataVolumeZScore,\n\nPERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY QueryRuntimeSeconds) OVER () AS QueryRuntime_P50,\nPERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY QueryRuntimeSeconds) OVER () AS QueryRuntime_P90,\nPERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY QueryRuntimeSeconds) OVER () AS QueryRuntime_P95,\nPERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY QueryRuntimeSeconds) OVER () AS QueryRuntime_P99,\n-- Queue Time\nPERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY QueueQueryTime) OVER () AS QueryQueueTime_P50,\nPERCENTILE_CONT(0.9) WITHIN GROUP (ORDER BY QueueQueryTime) OVER () AS QueryQueueTime_P90,\nPERCENTILE_CONT(0.95) WITHIN GROUP (ORDER BY QueueQueryTime) OVER () AS QueryQueueTime_P95,\nPERCENTILE_CONT(0.99) WITHIN GROUP (ORDER BY QueueQueryTime) OVER () AS QueryQueueTime_P99,\n\n-- DBT Dynamic Tag Parsing\nparsed_dbt_comment[:Selected_DBT_Key] AS Selected_DBT_Attribute_Value\nFROM query_level_intel_metrics\n)\n\nSELECT \n*,\nCASE WHEN DataVolumeZScore > (CASE WHEN length(:data_volume_min_z_score::float) > 1 THEN :data_volume_min_z_score::float ELSE 1 END) THEN 'High Relative Volume Read' ELSE 'Not High Relative Volume' END AS HighDataVolumeFlag,\nCASE WHEN DataVolumeZScore > (CASE WHEN length(:data_volume_min_z_score::float) > 1 THEN :data_volume_min_z_score::float ELSE 1 END) THEN 1 ELSE 0 END AS Calc_HighDataVolumeFlag,\n(Calc_HasSpillFlag + Calc_ReadDataFlag + Calc_UsedWorkerTasksFlag + Calc_LongRunningQueryFlag + Calc_HighDataVolumeFlag\n+ COALESCE(SpillAmountZScore, 0) + COALESCE(DataVolumeZScore, 0)) AS ProblemQueryMetric,\n\n-- P50, 90,95,99\nQueryRuntime_P50,\nQueryRuntime_P90,\nQueryRuntime_P95,\nQueryRuntime_P99,\n-- Queue Time\nQueryQueueTime_P50,\nQueryQueueTime_P90,\nQueryQueueTime_P95,\nQueryQueueTime_P99\nFROM zscores\n\n\n\n",
      "parameters": [
        {
          "displayName": "long_running_seconds_treshold",
          "keyword": "long_running_seconds_treshold",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "120"
                }
              ]
            }
          }
        },
        {
          "displayName": "warehouse_id",
          "keyword": "warehouse_id",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "475b94ddc7cd5211"
                }
              ]
            }
          }
        },
        {
          "displayName": "start_range",
          "keyword": "start_range",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "2024-03-22T19:40:34.000Z"
                }
              ]
            }
          }
        },
        {
          "displayName": "end_range",
          "keyword": "end_range",
          "dataType": "DATETIME",
          "defaultSelection": {
            "values": {
              "dataType": "DATETIME",
              "values": [
                {
                  "value": "2024-03-26T19:40:59.000Z"
                }
              ]
            }
          }
        },
        {
          "displayName": "cluster_unit_price",
          "keyword": "cluster_unit_price",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "0.7"
                }
              ]
            }
          }
        },
        {
          "displayName": "data_volume_min_z_score",
          "keyword": "data_volume_min_z_score",
          "dataType": "DECIMAL",
          "defaultSelection": {
            "values": {
              "dataType": "DECIMAL",
              "values": [
                {
                  "value": "2"
                }
              ]
            }
          }
        },
        {
          "displayName": "Selected_DBT_Key",
          "keyword": "Selected_DBT_Key",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "target_name"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "a50512a8",
      "displayName": "Warehouse Billing",
      "query": "\nWITH filtered_usage AS (SELECT \n*,\nusage_quantity*(:cluster_unit_price::float) AS UsageDollars\nFROM system.billing.usage\nWHERE usage_metadata.warehouse_id = :warehouse_id\n),\nusage_aggregated AS (\n  SELECT \n    date_trunc('hour', usage_start_time) AS usage_hour,\n    SUM(usage_quantity) AS UsageDBUs,\n    SUM(UsageDollars) AS UsageDollars\n  FROM filtered_usage \n  GROUP BY date_trunc('hour', usage_start_time)\n  ORDER BY usage_hour\n),\nsmoothed_usage AS (\nSELECT \n  usage_hour,\n  UsageDollars,\n  UsageDBUs,\n  AVG(UsageDollars) OVER (ORDER BY usage_hour ROWS BETWEEN 11 PRECEDING AND CURRENT ROW) AS fast_moving_average,\n  AVG(UsageDollars) OVER (ORDER BY usage_hour ROWS BETWEEN 23 PRECEDING AND CURRENT ROW) AS slow_moving_average\nFROM usage_aggregated\n),\npop_change AS (\nSELECT \n*,\nfast_moving_average - LAG(fast_moving_average, 12, 0) OVER (ORDER BY usage_hour) AS p12h_change,\nslow_moving_average - LAG(slow_moving_average, 24, 0) OVER (ORDER BY usage_hour) AS p24h_change\nFROM smoothed_usage\n),\n\nfinal_change AS (\nSELECT \n*,\nCOALESCE(ROUND(( try_divide(p12h_change , LAG(UsageDollars, 12, 0) OVER (ORDER BY usage_hour))) * 100, 2)::float, 0::float) AS p12h_change_percentage,\n ROUND((try_divide(p24h_change , LAG(UsageDollars, 24, 0) OVER (ORDER BY usage_hour))) * 100, 2)::float AS p24h_change_percentage\nFROM pop_change\n)\n\nSELECT \n*,\nCASE WHEN p24h_change_percentage > :percent_increase::float THEN 'High Momentum' ELSE 'Within Range' END AS HighIncreaseFlag -- i.e. greater than 20% increase period over period\nFROM final_change",
      "parameters": [
        {
          "displayName": "warehouse_id",
          "keyword": "warehouse_id",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "475b94ddc7cd5211"
                }
              ]
            }
          }
        },
        {
          "displayName": "cluster_unit_price",
          "keyword": "cluster_unit_price",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "0.7"
                }
              ]
            }
          }
        },
        {
          "displayName": "percent_increase",
          "keyword": "percent_increase",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "20"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "pages": [
    {
      "name": "ea232467",
      "displayName": "New Page",
      "layout": [
        {
          "widget": {
            "name": "01f674b3",
            "queries": [
              {
                "name": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacad13e14ae90b902c6c8537ea0_usage_hour",
                "query": {
                  "datasetName": "a50512a8",
                  "fields": [
                    {
                      "name": "usage_hour",
                      "expression": "`usage_hour`"
                    },
                    {
                      "name": "usage_hour_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "usage_hour",
                    "displayName": "usage_hour",
                    "queryName": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacad13e14ae90b902c6c8537ea0_usage_hour"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Usage Time Period"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 4,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "01faa6b4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "84491e8e",
                  "fields": [
                    {
                      "name": "max(NumberOfClustersOn)",
                      "expression": "MAX(`NumberOfClustersOn`)"
                    },
                    {
                      "name": "minutely(event_minute)",
                      "expression": "DATE_TRUNC(\"MINUTE\", `event_minute`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "minutely(event_minute)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "event_minute"
                },
                "y": {
                  "fieldName": "max(NumberOfClustersOn)",
                  "scale": {
                    "type": "quantitative",
                    "domain": {
                      "min": 0
                    }
                  },
                  "displayName": "Maximum NumberOfClustersOn"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Scaling Over Time"
              },
              "mark": {
                "colors": [
                  "#077A9D",
                  "#FFAB00",
                  "#00A972",
                  "#FF3621",
                  "#8BCAE7",
                  "#AB4057",
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 29,
            "width": 6,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "04e90263",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(QueryQueueTime_P50)",
                      "expression": "AVG(`QueryQueueTime_P50`)"
                    },
                    {
                      "name": "avg(QueryQueueTime_P90)",
                      "expression": "AVG(`QueryQueueTime_P90`)"
                    },
                    {
                      "name": "avg(QueryQueueTime_P95)",
                      "expression": "AVG(`QueryQueueTime_P95`)"
                    },
                    {
                      "name": "avg(QueryQueueTime_P99)",
                      "expression": "AVG(`QueryQueueTime_P99`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "scale": {
                    "type": "quantitative",
                    "reverse": false
                  },
                  "fields": [
                    {
                      "fieldName": "avg(QueryQueueTime_P50)",
                      "displayName": "P50"
                    },
                    {
                      "fieldName": "avg(QueryQueueTime_P90)",
                      "displayName": "P90"
                    },
                    {
                      "fieldName": "avg(QueryQueueTime_P95)",
                      "displayName": "P95"
                    },
                    {
                      "fieldName": "avg(QueryQueueTime_P99)",
                      "displayName": "P99"
                    }
                  ],
                  "axis": {
                    "title": "Query Queue Time (s)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Query Queue Time P50, 90, 95, 99"
              },
              "mark": {
                "layout": "group",
                "colors": [
                  "#8BCAE7",
                  "#2672cb",
                  "#00A972",
                  "#FF3621",
                  "#8BCAE7",
                  "#AB4057",
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ]
              }
            }
          },
          "position": {
            "x": 4,
            "y": 48,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "06712b37",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "node_id",
                      "expression": "`node_id`"
                    },
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    },
                    {
                      "name": "sum(ExecutionQueryTime)",
                      "expression": "SUM(`ExecutionQueryTime`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "sum(ExecutionQueryTime)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Total Query Time Share"
                  },
                  "displayName": "Total Query Time Share"
                },
                "y": {
                  "fieldName": "profile_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "profile_name"
                },
                "color": {
                  "fieldName": "node_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "node_id"
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showDescription": true,
                "description": "Compute Time By Profile & Node"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 75,
            "width": 2,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "08f5f8ae",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_DBT_Query_Type",
                "query": {
                  "datasetName": "4bf19021",
                  "fields": [
                    {
                      "name": "DBT_Query_Type",
                      "expression": "`DBT_Query_Type`"
                    },
                    {
                      "name": "DBT_Query_Type_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "DBT_Query_Type",
                    "displayName": "DBT_Query_Type",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_DBT_Query_Type"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Query Flag",
                "showDescription": true,
                "description": "Identify Queries from DBT"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 108,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "0b823bd4",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_start_range",
                "query": {
                  "datasetName": "9275d56b",
                  "parameters": [
                    {
                      "name": "start_range",
                      "keyword": "start_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "start_range",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_start_range"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Query Range Start "
              }
            }
          },
          "position": {
            "x": 4,
            "y": 36,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "11374e15",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(QueueQueryTime)",
                      "expression": "AVG(`QueueQueryTime`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(QueueQueryTime)",
                  "displayName": "Average QueueQueryTime"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Queue Time (s)"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 40,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "1469d3ec",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(QueryRuntimeSeconds)",
                      "expression": "AVG(`QueryRuntimeSeconds`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(QueryRuntimeSeconds)",
                  "displayName": "Average QueryRuntimeSeconds"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Query Time (s)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 40,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "16d831b3",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "84491e8e",
                  "fields": [
                    {
                      "name": "NumberOfClustersOn",
                      "expression": "`NumberOfClustersOn`"
                    },
                    {
                      "name": "countdistinct(event_minute)",
                      "expression": "COUNT(DISTINCT `event_minute`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "y": {
                  "fieldName": "countdistinct(event_minute)",
                  "scale": {
                    "type": "quantitative",
                    "reverse": true
                  },
                  "axis": {
                    "title": "Num Minutes On N Clusters"
                  },
                  "displayName": "# Minutes On Cluster N"
                },
                "color": {
                  "fieldName": "NumberOfClustersOn",
                  "scale": {
                    "type": "quantitative",
                    "colorRamp": {
                      "mode": "scheme",
                      "scheme": "greenblue"
                    }
                  },
                  "displayName": "# Scaled Clusters"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "% of Time Warehouse Scaled at Cluster N"
              },
              "mark": {
                "layout": "percent-stack"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 23,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "1e127fd9",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_warehouse_id",
                "query": {
                  "datasetName": "9275d56b",
                  "parameters": [
                    {
                      "name": "warehouse_id",
                      "keyword": "warehouse_id"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "warehouse_id",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_warehouse_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 36,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "1ecb8533",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_long_running_seconds_treshold",
                "query": {
                  "datasetName": "9275d56b",
                  "parameters": [
                    {
                      "name": "long_running_seconds_treshold",
                      "keyword": "long_running_seconds_treshold"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "long_running_seconds_treshold",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_long_running_seconds_treshold"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Long Running Query Threshold (s) For Flag"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 83,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "1f0278fb",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(QueryRuntime_P50)",
                      "expression": "AVG(`QueryRuntime_P50`)"
                    },
                    {
                      "name": "avg(QueryRuntime_P90)",
                      "expression": "AVG(`QueryRuntime_P90`)"
                    },
                    {
                      "name": "avg(QueryRuntime_P95)",
                      "expression": "AVG(`QueryRuntime_P95`)"
                    },
                    {
                      "name": "avg(QueryRuntime_P99)",
                      "expression": "AVG(`QueryRuntime_P99`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "scale": {
                    "type": "quantitative",
                    "reverse": false
                  },
                  "fields": [
                    {
                      "fieldName": "avg(QueryRuntime_P50)",
                      "displayName": "P50"
                    },
                    {
                      "fieldName": "avg(QueryRuntime_P90)",
                      "displayName": "P90"
                    },
                    {
                      "fieldName": "avg(QueryRuntime_P95)",
                      "displayName": "P95"
                    },
                    {
                      "fieldName": "avg(QueryRuntime_P99)",
                      "displayName": "P99"
                    }
                  ],
                  "axis": {
                    "title": "Query Runtime (s)"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Query Runtime P50, 90, 95, 99"
              },
              "mark": {
                "layout": "group",
                "colors": [
                  "#8BCAE7",
                  "#2672cb",
                  "#00A972",
                  "#FF3621",
                  "#8BCAE7",
                  "#AB4057",
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ]
              }
            }
          },
          "position": {
            "x": 4,
            "y": 42,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "204a7182",
            "textbox_spec": "### Query Performance Detail"
          },
          "position": {
            "x": 0,
            "y": 82,
            "width": 6,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "21f18190",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacee7a719909f9b3d31305cc095_warehouse_id",
                "query": {
                  "datasetName": "84491e8e",
                  "parameters": [
                    {
                      "name": "warehouse_id",
                      "keyword": "warehouse_id"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "warehouse_id",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacee7a719909f9b3d31305cc095_warehouse_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Id"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 21,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "229baf20",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "sum(QueryRuntimeSeconds)",
                      "expression": "SUM(`QueryRuntimeSeconds`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(QueryRuntimeSeconds)",
                  "displayName": "Sum of QueryRuntimeSeconds"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Query Time (s)"
              }
            }
          },
          "position": {
            "x": 5,
            "y": 40,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "25c5939e",
            "textbox_spec": "## Section 2: Warehouse Scaling Trends\n-----"
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "25ec1060",
            "textbox_spec": "## Section 1: Warehouse Billing Trends\n-----"
          },
          "position": {
            "x": 0,
            "y": 3,
            "width": 6,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "32b26323",
            "textbox_spec": "## Section 3: Query History Analysis (with filters and charts for DBT models)\n-----"
          },
          "position": {
            "x": 0,
            "y": 35,
            "width": 6,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "34877ba7",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacad13e14ae90b902c6c8537ea0_cluster_unit_price",
                "query": {
                  "datasetName": "a50512a8",
                  "parameters": [
                    {
                      "name": "cluster_unit_price",
                      "keyword": "cluster_unit_price"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "cluster_unit_price",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacad13e14ae90b902c6c8537ea0_cluster_unit_price"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Cluster Unit Price ($)"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 4,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "35979a8c",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "84491e8e",
                  "fields": [
                    {
                      "name": "avg(NumberOfClustersOn)",
                      "expression": "AVG(`NumberOfClustersOn`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(NumberOfClustersOn)",
                  "displayName": "Average NumberOfClustersOn"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Scaled Clusters"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 21,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "3dd6e1e6",
            "queries": [
              {
                "name": "parameter_dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_Selected_DBT_Key",
                "query": {
                  "datasetName": "4bf19021",
                  "parameters": [
                    {
                      "name": "Selected_DBT_Key",
                      "keyword": "Selected_DBT_Key"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "Selected_DBT_Key",
                    "queryName": "parameter_dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_Selected_DBT_Key"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Custom Attribute Filter",
                "showDescription": true,
                "description": "Specify Custom Key in DBT metadata to group on value (default is None)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 106,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "426062db",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_cluster_unit_price",
                "query": {
                  "datasetName": "4bf19021",
                  "parameters": [
                    {
                      "name": "cluster_unit_price",
                      "keyword": "cluster_unit_price"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "cluster_unit_price",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_cluster_unit_price"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Unit Price ($)"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 106,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "4391614f",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_target_name",
                "query": {
                  "datasetName": "4bf19021",
                  "fields": [
                    {
                      "name": "target_name",
                      "expression": "`target_name`"
                    },
                    {
                      "name": "target_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "target_name",
                    "displayName": "target_name",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_target_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Target Name"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 108,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "44e71164",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "DBT_Query_Type",
                      "expression": "`DBT_Query_Type`"
                    },
                    {
                      "name": "avg(QueryRuntimeSeconds)",
                      "expression": "AVG(`QueryRuntimeSeconds`)"
                    },
                    {
                      "name": "target_name",
                      "expression": "`target_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "heatmap",
              "encodings": {
                "x": {
                  "fieldName": "target_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "target_name"
                },
                "y": {
                  "fieldName": "DBT_Query_Type",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "DBT_Query_Type"
                },
                "color": {
                  "fieldName": "avg(QueryRuntimeSeconds)",
                  "scale": {
                    "type": "quantitative",
                    "colorRamp": {
                      "mode": "scheme",
                      "scheme": "greenblue"
                    }
                  },
                  "displayName": "Query Runtime"
                }
              },
              "frame": {
                "showTitle": true,
                "showDescription": false,
                "title": "Query Runtime By DBT Target"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 54,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "464b0884",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "4bf19021",
                  "fields": [
                    {
                      "name": "AvgRuntimeInSeconds",
                      "expression": "`AvgRuntimeInSeconds`"
                    },
                    {
                      "name": "NumberOfExecutions",
                      "expression": "`NumberOfExecutions`"
                    },
                    {
                      "name": "QueryProportionParetoFlag",
                      "expression": "`QueryProportionParetoFlag`"
                    },
                    {
                      "name": "Selected_DBT_Key",
                      "expression": "`Selected_DBT_Key`"
                    },
                    {
                      "name": "StatementAllocatedDBUs",
                      "expression": "`StatementAllocatedDBUs`"
                    },
                    {
                      "name": "StatementAllocatedDollars",
                      "expression": "`StatementAllocatedDollars`"
                    },
                    {
                      "name": "StatementWarehouseTimePercentage",
                      "expression": "`StatementWarehouseTimePercentage`"
                    },
                    {
                      "name": "StatusErrorCounts",
                      "expression": "`StatusErrorCounts`"
                    },
                    {
                      "name": "TotalStatementTimeUsed",
                      "expression": "`TotalStatementTimeUsed`"
                    },
                    {
                      "name": "UserRunCounts",
                      "expression": "`UserRunCounts`"
                    },
                    {
                      "name": "app",
                      "expression": "`app`"
                    },
                    {
                      "name": "dbt_version",
                      "expression": "`dbt_version`"
                    },
                    {
                      "name": "node_id",
                      "expression": "`node_id`"
                    },
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    },
                    {
                      "name": "statement_text",
                      "expression": "`statement_text`"
                    },
                    {
                      "name": "target_name",
                      "expression": "`target_name`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "statement_text",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "Query",
                    "allowSearch": true,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": null
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "QueryProportionParetoFlag",
                            "fn": "!=",
                            "literal": "Remaining Long Tail of Queries"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        }
                      ]
                    },
                    "displayName": "statement_text"
                  },
                  {
                    "fieldName": "StatementAllocatedDollars",
                    "numberFormat": "$0.0000",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 1,
                    "title": "Allocated Cost ($)",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": "#0b8536"
                      },
                      "rules": []
                    },
                    "displayName": "StatementAllocatedDollars"
                  },
                  {
                    "fieldName": "StatementAllocatedDBUs",
                    "numberFormat": "0.0000",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2,
                    "title": "Allocated DBUs",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "StatementAllocatedDBUs"
                  },
                  {
                    "fieldName": "StatementWarehouseTimePercentage",
                    "numberFormat": "%0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "% of Warehouse Execution Time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": "#356AFF"
                      },
                      "rules": []
                    },
                    "displayName": "StatementWarehouseTimePercentage"
                  },
                  {
                    "fieldName": "NumberOfExecutions",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4,
                    "title": "# Executions",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "NumberOfExecutions"
                  },
                  {
                    "fieldName": "AvgRuntimeInSeconds",
                    "numberFormat": "0.0000",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 5,
                    "title": "Avg Runtime (s)",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": "#356AFF"
                      },
                      "rules": []
                    },
                    "displayName": "AvgRuntimeInSeconds"
                  },
                  {
                    "fieldName": "StatusErrorCounts",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 6,
                    "title": "StatusErrorCounts",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "description": "Breakdown of execution by status and error",
                    "displayName": "StatusErrorCounts"
                  },
                  {
                    "fieldName": "UserRunCounts",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "complex",
                    "displayAs": "json",
                    "visible": true,
                    "order": 7,
                    "title": "User Run Breakdown",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "description": "Shows a detailed list of the users that executed this query and how often",
                    "displayName": "UserRunCounts"
                  },
                  {
                    "fieldName": "TotalStatementTimeUsed",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 9,
                    "title": "TotalStatementTimeUsed",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": "#356AFF"
                      },
                      "rules": []
                    },
                    "displayName": "TotalStatementTimeUsed"
                  },
                  {
                    "fieldName": "app",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 16,
                    "title": "app",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "app"
                  },
                  {
                    "fieldName": "node_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 17,
                    "title": "node_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "node_id"
                  },
                  {
                    "fieldName": "profile_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 18,
                    "title": "profile_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "profile_name"
                  },
                  {
                    "fieldName": "target_name",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 19,
                    "title": "target_name",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "target_name"
                  },
                  {
                    "fieldName": "dbt_version",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 20,
                    "title": "dbt_version",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "dbt_version"
                  },
                  {
                    "fieldName": "Selected_DBT_Key",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 25,
                    "title": "Selected_DBT_Key",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "Selected_DBT_Key"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "TotalWarehouseTimeUsed",
                  "type": "float",
                  "displayAs": "number",
                  "order": 8,
                  "title": "TotalWarehouseTimeUsed",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "%0.0000",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "StatementTaskTimeProportion",
                  "type": "float",
                  "displayAs": "number",
                  "order": 10,
                  "title": "StatementTaskTimeProportion",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false,
                  "cellFormat": {
                    "default": {
                      "foregroundColor": "#002FB4"
                    },
                    "rules": []
                  }
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "CumulativeProportionOfWarehouseTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 11,
                  "title": "CumulativeProportionOfWarehouseTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryProportionParetoFlag",
                  "type": "string",
                  "displayAs": "string",
                  "order": 12,
                  "title": "QueryProportionParetoFlag",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Total_Warehouse_Period_DBUs",
                  "type": "float",
                  "displayAs": "number",
                  "order": 13,
                  "title": "Total_Warehouse_Period_DBUs",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Total_Warehouse_Period_Dollars",
                  "type": "float",
                  "displayAs": "number",
                  "order": 14,
                  "title": "Total_Warehouse_Period_Dollars",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "query_signature",
                  "type": "string",
                  "displayAs": "string",
                  "order": 15,
                  "title": "query_signature",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "dbt_databricks_version",
                  "type": "string",
                  "displayAs": "string",
                  "order": 21,
                  "title": "dbt_databricks_version",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "dbt_metadata_json",
                  "type": "string",
                  "displayAs": "string",
                  "order": 22,
                  "title": "dbt_metadata_json",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "parsed_dbt_comment",
                  "type": "complex",
                  "displayAs": "json",
                  "order": 23,
                  "title": "parsed_dbt_comment",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "DBT_Query_Type",
                  "type": "string",
                  "displayAs": "string",
                  "order": 24,
                  "title": "DBT_Query_Type",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query Statement Resource Allocation Detail",
                "description": "Pareto Analysis Detail (Red means it is a top query in the Pareto Analysis)\n+ you can get user level query execution details by scrolling this table -->"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 116,
            "width": 6,
            "height": 9
          }
        },
        {
          "widget": {
            "name": "47a1c4c1",
            "queries": [
              {
                "name": "parameter_dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_data_volume_min_z_score",
                "query": {
                  "datasetName": "9275d56b",
                  "parameters": [
                    {
                      "name": "data_volume_min_z_score",
                      "keyword": "data_volume_min_z_score"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "data_volume_min_z_score",
                    "queryName": "parameter_dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_data_volume_min_z_score"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Data Volume Z Score Flag (relative volume to others in Warehouse)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 83,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "47d9637a",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_target_name",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "target_name",
                      "expression": "`target_name`"
                    },
                    {
                      "name": "target_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "target_name",
                    "displayName": "target_name",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_target_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Target"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 38,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "4b858975",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "HighDataVolumeFlag",
                      "expression": "`HighDataVolumeFlag`"
                    },
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Queries"
                  },
                  "displayName": "Queries"
                },
                "color": {
                  "fieldName": "HighDataVolumeFlag",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "Used Cache",
                        "color": "#00A972"
                      },
                      {
                        "value": "No Cache",
                        "color": "#8BCAE7"
                      },
                      {
                        "value": "No Spill",
                        "color": "#00A972"
                      },
                      {
                        "value": "High Relative Volume Read",
                        "color": "#AB4057"
                      },
                      {
                        "value": "Not High Relative Volume",
                        "color": "#00A972"
                      }
                    ]
                  },
                  "legend": {
                    "position": "bottom"
                  },
                  "displayName": "Has Spill"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Queries With High Data Volume"
              },
              "mark": {
                "layout": "stack"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 91,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "5140c25c",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_profile_name",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    },
                    {
                      "name": "profile_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "profile_name",
                    "displayName": "profile_name",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_profile_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Profile Name"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 38,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "5227a506",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "4bf19021",
                  "fields": [
                    {
                      "name": "DBT_Query_Type",
                      "expression": "`DBT_Query_Type`"
                    },
                    {
                      "name": "sum(StatementWarehouseTimePercentage)",
                      "expression": "SUM(`StatementWarehouseTimePercentage`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "y": {
                  "fieldName": "sum(StatementWarehouseTimePercentage)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "% of Total Warehouse Compute Time"
                },
                "color": {
                  "fieldName": "DBT_Query_Type",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "DBT Query",
                        "color": "#e2771c"
                      }
                    ]
                  },
                  "legend": {
                    "position": "bottom"
                  },
                  "displayName": "DBT_Query_Type"
                }
              },
              "mark": {
                "layout": "percent-stack"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 110,
            "width": 1,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "5bb6fbab",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "4bf19021",
                  "fields": [
                    {
                      "name": "node_id",
                      "expression": "`node_id`"
                    },
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    },
                    {
                      "name": "sum(StatementWarehouseTimePercentage)",
                      "expression": "SUM(`StatementWarehouseTimePercentage`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "node_id",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "y-reversed"
                    }
                  },
                  "displayName": "node_id"
                },
                "y": {
                  "fieldName": "sum(StatementWarehouseTimePercentage)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Node % of Total Warehouse Time"
                },
                "color": {
                  "fieldName": "profile_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "profile_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Nodes by % of Warehouse Compute"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 110,
            "width": 5,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "5c761c7f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "count(*)",
                  "displayName": "Count of Records"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Query Count"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 40,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "5c800ea6",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "node_id",
                      "expression": "`node_id`"
                    },
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Query Count"
                },
                "y": {
                  "fieldName": "profile_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "profile_name"
                },
                "color": {
                  "fieldName": "node_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "node_id"
                }
              },
              "frame": {
                "showDescription": true,
                "description": "Query Count By Profile & Node"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 75,
            "width": 2,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "60598e60",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "HasSpillFlag",
                      "expression": "`HasSpillFlag`"
                    },
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Queries"
                  },
                  "displayName": "Queries"
                },
                "color": {
                  "fieldName": "HasSpillFlag",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "Used Cache",
                        "color": "#00A972"
                      },
                      {
                        "value": "No Cache",
                        "color": "#8BCAE7"
                      },
                      {
                        "value": "No Spill",
                        "color": "#00A972"
                      }
                    ]
                  },
                  "legend": {
                    "position": "bottom"
                  },
                  "displayName": "Has Spill"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Queries With Spill"
              },
              "mark": {
                "layout": "stack"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 85,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "6c7fda11",
            "queries": [
              {
                "name": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacee7a719909f9b3d31305cc095_event_minute",
                "query": {
                  "datasetName": "84491e8e",
                  "fields": [
                    {
                      "name": "event_minute",
                      "expression": "`event_minute`"
                    },
                    {
                      "name": "event_minute_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-range-picker",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "event_minute",
                    "displayName": "event_minute",
                    "queryName": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacee7a719909f9b3d31305cc095_event_minute"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Event Time"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 21,
            "width": 3,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "74e15733",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(ProportionQueueTime)",
                      "expression": "AVG(`ProportionQueueTime`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(ProportionQueueTime)",
                  "displayName": "Average ProportionQueueTime"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "% Time Queued"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 40,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "7771bd64",
            "queries": [
              {
                "name": "parameter_dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe016808a0f30568104d99c_percent_increase",
                "query": {
                  "datasetName": "a50512a8",
                  "parameters": [
                    {
                      "name": "percent_increase",
                      "keyword": "percent_increase"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "percent_increase",
                    "queryName": "parameter_dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe016808a0f30568104d99c_percent_increase"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "High Increase % Barrier"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 4,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "784e8d64",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_node_id",
                "query": {
                  "datasetName": "4bf19021",
                  "fields": [
                    {
                      "name": "node_id",
                      "expression": "`node_id`"
                    },
                    {
                      "name": "node_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "node_id",
                    "displayName": "node_id",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_node_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Node Id"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 108,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "790e03c6",
            "queries": [
              {
                "name": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_HasSpillFlag",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "HasSpillFlag",
                      "expression": "`HasSpillFlag`"
                    },
                    {
                      "name": "HasSpillFlag_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "HasSpillFlag",
                    "displayName": "HasSpillFlag",
                    "queryName": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_HasSpillFlag"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Has Spill Flag"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 83,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "7aa55330",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(QueryRuntimeSeconds)",
                      "expression": "AVG(`QueryRuntimeSeconds`)"
                    },
                    {
                      "name": "node_id",
                      "expression": "`node_id`"
                    },
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "heatmap",
              "encodings": {
                "x": {
                  "fieldName": "profile_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "axis": {
                    "title": "DBT Profile Name"
                  },
                  "displayName": "DBT Profile Name"
                },
                "y": {
                  "fieldName": "node_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "DBT Node Id"
                },
                "color": {
                  "fieldName": "avg(QueryRuntimeSeconds)",
                  "scale": {
                    "type": "quantitative",
                    "colorRamp": {
                      "mode": "scheme",
                      "scheme": "greenblue"
                    }
                  },
                  "displayName": "Avg Query Runtime"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Query Runtime By DBT Profile, Node"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 54,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "7bbf1e7f",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "countdistinct(executed_by)",
                      "expression": "COUNT(DISTINCT `executed_by`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(executed_by)",
                  "displayName": "Count of Unique executed_by"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Active Users"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 40,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "80656c4d",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_end_range",
                "query": {
                  "datasetName": "9275d56b",
                  "parameters": [
                    {
                      "name": "end_range",
                      "keyword": "end_range"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "end_range",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_end_range"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Query Range End "
              }
            }
          },
          "position": {
            "x": 5,
            "y": 36,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "8be5e095",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "execution_status",
                      "expression": "`execution_status`"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Query Count"
                  },
                  "displayName": "Query Count"
                },
                "color": {
                  "fieldName": "execution_status",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "FAILED",
                        "color": "#FF3621"
                      },
                      {
                        "value": "FINISHED",
                        "color": "#00A972"
                      },
                      {
                        "value": "CANCELED",
                        "color": "#919191"
                      }
                    ]
                  },
                  "legend": {
                    "title": "Execution Status",
                    "position": "bottom"
                  },
                  "displayName": "Execution Status"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Queries by Status Over Time"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 60,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "8fc60ef7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "UsedCacheFlag",
                      "expression": "`UsedCacheFlag`"
                    },
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Queries"
                  },
                  "displayName": "Queries"
                },
                "color": {
                  "fieldName": "UsedCacheFlag",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "Used Cache",
                        "color": "#00A972"
                      },
                      {
                        "value": "No Cache",
                        "color": "#8BCAE7"
                      }
                    ]
                  },
                  "legend": {
                    "title": "Used Cache",
                    "position": "bottom"
                  },
                  "displayName": "Used Cache"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Queries Using Cache"
              },
              "mark": {
                "layout": "stack"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 91,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "933991e5",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_start_time",
                "query": {
                  "datasetName": "4bf19021",
                  "parameters": [
                    {
                      "name": "start_time",
                      "keyword": "start_time"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "start_time",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_start_time"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Query Range Start"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 106,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "93ec38a2",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_profile_name",
                "query": {
                  "datasetName": "4bf19021",
                  "fields": [
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    },
                    {
                      "name": "profile_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "profile_name",
                    "displayName": "profile_name",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afe61f08b608e47653f186bd_profile_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Profile Name"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 108,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "969a70b4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a50512a8",
                  "fields": [
                    {
                      "name": "sum(UsageDBUs)",
                      "expression": "SUM(`UsageDBUs`)"
                    },
                    {
                      "name": "sum(UsageDollars)",
                      "expression": "SUM(`UsageDollars`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(UsageDollars)",
                  "displayName": "Sum of UsageDollars"
                },
                "target": {
                  "fieldName": "sum(UsageDBUs)",
                  "displayName": "Sum of UsageDBUs"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "$ Spend In Period",
                "showDescription": true,
                "description": "(DBUs)"
              }
            }
          },
          "position": {
            "x": 5,
            "y": 4,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "988d7dc4",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "LongRunningQueryFlag",
                      "expression": "`LongRunningQueryFlag`"
                    },
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Queries"
                  },
                  "displayName": "Queries"
                },
                "color": {
                  "fieldName": "LongRunningQueryFlag",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "Used Cache",
                        "color": "#00A972"
                      },
                      {
                        "value": "No Cache",
                        "color": "#8BCAE7"
                      },
                      {
                        "value": "Short Running",
                        "color": "#00A972"
                      },
                      {
                        "value": "Long Running",
                        "color": "#FFAB00"
                      }
                    ]
                  },
                  "legend": {
                    "position": "bottom"
                  },
                  "displayName": "Query Length"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Queries Long Running"
              },
              "mark": {
                "layout": "stack"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 85,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "9a55df18",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(read_io_cache_percent)",
                      "expression": "AVG(`read_io_cache_percent`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "combo",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "primary": {
                    "fields": [
                      {
                        "fieldName": "avg(read_io_cache_percent)",
                        "displayName": "Avg % Cache"
                      }
                    ]
                  },
                  "secondary": {
                    "fields": []
                  },
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "legend": {
                    "position": "bottom"
                  }
                }
              },
              "mark": {
                "colors": [
                  "#8BCAE7",
                  "#FF3621",
                  "#8BCAE7",
                  "#AB4057",
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Caching Trends"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 65,
            "width": 4,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "9d780fda",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_node_id",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "node_id",
                      "expression": "`node_id`"
                    },
                    {
                      "name": "node_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "node_id",
                    "displayName": "node_id",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_node_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Node Id (Model Step)"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 38,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "a09b8df8",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_end_time",
                "query": {
                  "datasetName": "4bf19021",
                  "parameters": [
                    {
                      "name": "end_time",
                      "keyword": "end_time"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "end_time",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_end_time"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Query Range End"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 106,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "a5e47931",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "AllocatedQueryCostByTime",
                      "expression": "`AllocatedQueryCostByTime`"
                    },
                    {
                      "name": "CPUTotalExecutionTime",
                      "expression": "`CPUTotalExecutionTime`"
                    },
                    {
                      "name": "CachePercentZScore",
                      "expression": "`CachePercentZScore`"
                    },
                    {
                      "name": "CompilationQueryTime",
                      "expression": "`CompilationQueryTime`"
                    },
                    {
                      "name": "ExecutionQueryTime",
                      "expression": "`ExecutionQueryTime`"
                    },
                    {
                      "name": "HasSpillFlag",
                      "expression": "`HasSpillFlag`"
                    },
                    {
                      "name": "HighDataVolumeFlag",
                      "expression": "`HighDataVolumeFlag`"
                    },
                    {
                      "name": "LongRunningQueryFlag",
                      "expression": "`LongRunningQueryFlag`"
                    },
                    {
                      "name": "ProblemQueryMetric",
                      "expression": "`ProblemQueryMetric`"
                    },
                    {
                      "name": "ProportionQueueTime",
                      "expression": "`ProportionQueueTime`"
                    },
                    {
                      "name": "QueryEfficiencyRatio",
                      "expression": "`QueryEfficiencyRatio`"
                    },
                    {
                      "name": "QueryRuntimeSeconds",
                      "expression": "`QueryRuntimeSeconds`"
                    },
                    {
                      "name": "QueueQueryTime",
                      "expression": "`QueueQueryTime`"
                    },
                    {
                      "name": "ReadDataAmountInGB",
                      "expression": "`ReadDataAmountInGB`"
                    },
                    {
                      "name": "ReadDataFlag",
                      "expression": "`ReadDataFlag`"
                    },
                    {
                      "name": "ResultFetchTime",
                      "expression": "`ResultFetchTime`"
                    },
                    {
                      "name": "StartUpQueryTime",
                      "expression": "`StartUpQueryTime`"
                    },
                    {
                      "name": "TotalCPUTime_To_Execution_Time_Ratio",
                      "expression": "`TotalCPUTime_To_Execution_Time_Ratio`"
                    },
                    {
                      "name": "UsedCacheFlag",
                      "expression": "`UsedCacheFlag`"
                    },
                    {
                      "name": "UsedWorkerTasksFlag",
                      "expression": "`UsedWorkerTasksFlag`"
                    },
                    {
                      "name": "WarehouseAvgTaskToExecutionTimeRatio",
                      "expression": "`WarehouseAvgTaskToExecutionTimeRatio`"
                    },
                    {
                      "name": "end_time",
                      "expression": "`end_time`"
                    },
                    {
                      "name": "executed_by",
                      "expression": "`executed_by`"
                    },
                    {
                      "name": "execution_status",
                      "expression": "`execution_status`"
                    },
                    {
                      "name": "from_result_cache",
                      "expression": "`from_result_cache`"
                    },
                    {
                      "name": "read_bytes",
                      "expression": "`read_bytes`"
                    },
                    {
                      "name": "read_io_cache_percent",
                      "expression": "`read_io_cache_percent`"
                    },
                    {
                      "name": "spilled_local_bytes",
                      "expression": "`spilled_local_bytes`"
                    },
                    {
                      "name": "start_time",
                      "expression": "`start_time`"
                    },
                    {
                      "name": "statement_id",
                      "expression": "`statement_id`"
                    },
                    {
                      "name": "statement_text",
                      "expression": "`statement_text`"
                    },
                    {
                      "name": "statement_type",
                      "expression": "`statement_type`"
                    },
                    {
                      "name": "update_time",
                      "expression": "`update_time`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "table",
              "encodings": {
                "columns": [
                  {
                    "fieldName": "statement_id",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 0,
                    "title": "statement_id",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "cellFormat": {
                      "default": {
                        "foregroundColor": "#356AFF"
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "execution_status",
                            "fn": "=",
                            "literal": "FINISHED"
                          },
                          "value": {
                            "foregroundColor": "#3BD973"
                          }
                        },
                        {
                          "if": {
                            "column": "execution_status",
                            "fn": "=",
                            "literal": "FAILED"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        },
                        {
                          "if": {
                            "column": "execution_status",
                            "fn": "=",
                            "literal": "CANCELED"
                          },
                          "value": {
                            "foregroundColor": "#494949"
                          }
                        }
                      ]
                    },
                    "displayName": "statement_id"
                  },
                  {
                    "fieldName": "AllocatedQueryCostByTime",
                    "numberFormat": "$0.0000",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 1,
                    "title": "Query Cost ($)",
                    "allowSearch": false,
                    "alignContent": "center",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "description": "Query Cost Allocated By Total Runtime In Warehouse Period",
                    "cellFormat": {
                      "default": {
                        "foregroundColor": "#002FB4"
                      },
                      "rules": []
                    },
                    "displayName": "AllocatedQueryCostByTime"
                  },
                  {
                    "fieldName": "ProblemQueryMetric",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 2,
                    "title": "Problem Query Metric (higher is worse",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "description": "Metric that sums up flags such as high volume, spill, query efficiency (the higher the most likely this is an inefficient query",
                    "cellFormat": {
                      "default": {
                        "foregroundColor": "#000000"
                      },
                      "rules": [
                        {
                          "if": {
                            "column": "ProblemQueryMetric",
                            "fn": ">=",
                            "literal": "2"
                          },
                          "value": {
                            "foregroundColor": "#E92828"
                          }
                        },
                        {
                          "if": {
                            "column": "ProblemQueryMetric",
                            "fn": ">=",
                            "literal": "1"
                          },
                          "value": {
                            "foregroundColor": "#FB8D3D"
                          }
                        }
                      ]
                    },
                    "displayName": "ProblemQueryMetric"
                  },
                  {
                    "fieldName": "QueryEfficiencyRatio",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 3,
                    "title": "Efficiency Ratio (Experimental)",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "description": "EXPERIMENTAL - Ratio of Execution Time to Total CPU Time (higher is worse)",
                    "displayName": "QueryEfficiencyRatio"
                  },
                  {
                    "fieldName": "QueryRuntimeSeconds",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 4,
                    "title": "Runtime (s)",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "QueryRuntimeSeconds"
                  },
                  {
                    "fieldName": "statement_text",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 5,
                    "title": "Query",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "statement_text"
                  },
                  {
                    "fieldName": "execution_status",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 9,
                    "title": "execution_status",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "execution_status"
                  },
                  {
                    "fieldName": "statement_type",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 10,
                    "title": "statement_type",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "statement_type"
                  },
                  {
                    "fieldName": "executed_by",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 11,
                    "title": "executed_by",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "executed_by"
                  },
                  {
                    "fieldName": "CPUTotalExecutionTime",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 12,
                    "title": "CPUTotalExecutionTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "CPUTotalExecutionTime"
                  },
                  {
                    "fieldName": "ExecutionQueryTime",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 13,
                    "title": "ExecutionQueryTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "ExecutionQueryTime"
                  },
                  {
                    "fieldName": "CompilationQueryTime",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 14,
                    "title": "CompilationQueryTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "CompilationQueryTime"
                  },
                  {
                    "fieldName": "QueueQueryTime",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 15,
                    "title": "QueueQueryTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "QueueQueryTime"
                  },
                  {
                    "fieldName": "StartUpQueryTime",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 16,
                    "title": "StartUpQueryTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "StartUpQueryTime"
                  },
                  {
                    "fieldName": "ResultFetchTime",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 17,
                    "title": "ResultFetchTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "ResultFetchTime"
                  },
                  {
                    "fieldName": "start_time",
                    "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 18,
                    "title": "start_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "start_time"
                  },
                  {
                    "fieldName": "end_time",
                    "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 19,
                    "title": "end_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "end_time"
                  },
                  {
                    "fieldName": "update_time",
                    "dateTimeFormat": "YYYY-MM-DD HH:mm:ss.SSS",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "datetime",
                    "displayAs": "datetime",
                    "visible": true,
                    "order": 20,
                    "title": "update_time",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "update_time"
                  },
                  {
                    "fieldName": "TotalCPUTime_To_Execution_Time_Ratio",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 21,
                    "title": "TotalCPUTime_To_Execution_Time_Ratio",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "TotalCPUTime_To_Execution_Time_Ratio"
                  },
                  {
                    "fieldName": "ProportionQueueTime",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 22,
                    "title": "ProportionQueueTime",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "ProportionQueueTime"
                  },
                  {
                    "fieldName": "read_bytes",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 23,
                    "title": "read_bytes",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "read_bytes"
                  },
                  {
                    "fieldName": "read_io_cache_percent",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 24,
                    "title": "read_io_cache_percent",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "read_io_cache_percent"
                  },
                  {
                    "fieldName": "from_result_cache",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "boolean",
                    "displayAs": "boolean",
                    "visible": true,
                    "order": 25,
                    "title": "from_result_cache",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "from_result_cache"
                  },
                  {
                    "fieldName": "spilled_local_bytes",
                    "numberFormat": "0",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "integer",
                    "displayAs": "number",
                    "visible": true,
                    "order": 26,
                    "title": "spilled_local_bytes",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "spilled_local_bytes"
                  },
                  {
                    "fieldName": "ReadDataAmountInGB",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 33,
                    "title": "ReadDataAmountInGB",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "ReadDataAmountInGB"
                  },
                  {
                    "fieldName": "ReadDataFlag",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 34,
                    "title": "ReadDataFlag",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "ReadDataFlag"
                  },
                  {
                    "fieldName": "UsedWorkerTasksFlag",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 35,
                    "title": "UsedWorkerTasksFlag",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "UsedWorkerTasksFlag"
                  },
                  {
                    "fieldName": "LongRunningQueryFlag",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 36,
                    "title": "LongRunningQueryFlag",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "LongRunningQueryFlag"
                  },
                  {
                    "fieldName": "WarehouseAvgTaskToExecutionTimeRatio",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 37,
                    "title": "WarehouseAvgTaskToExecutionTimeRatio",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "WarehouseAvgTaskToExecutionTimeRatio"
                  },
                  {
                    "fieldName": "CachePercentZScore",
                    "numberFormat": "0.00",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "float",
                    "displayAs": "number",
                    "visible": true,
                    "order": 45,
                    "title": "CachePercentZScore",
                    "allowSearch": false,
                    "alignContent": "right",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "CachePercentZScore"
                  },
                  {
                    "fieldName": "HasSpillFlag",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 46,
                    "title": "HasSpillFlag",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "HasSpillFlag"
                  },
                  {
                    "fieldName": "UsedCacheFlag",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 51,
                    "title": "UsedCacheFlag",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "UsedCacheFlag"
                  },
                  {
                    "fieldName": "HighDataVolumeFlag",
                    "booleanValues": [
                      "false",
                      "true"
                    ],
                    "imageUrlTemplate": "{{ @ }}",
                    "imageTitleTemplate": "{{ @ }}",
                    "imageWidth": "",
                    "imageHeight": "",
                    "linkUrlTemplate": "{{ @ }}",
                    "linkTextTemplate": "{{ @ }}",
                    "linkTitleTemplate": "{{ @ }}",
                    "linkOpenInNewTab": true,
                    "type": "string",
                    "displayAs": "string",
                    "visible": true,
                    "order": 52,
                    "title": "HighDataVolumeFlag",
                    "allowSearch": false,
                    "alignContent": "left",
                    "allowHTML": false,
                    "highlightLinks": false,
                    "useMonospaceFont": false,
                    "preserveWhitespace": false,
                    "displayName": "HighDataVolumeFlag"
                  }
                ]
              },
              "invisibleColumns": [
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "SpillAmountZScore",
                  "type": "float",
                  "displayAs": "number",
                  "order": 6,
                  "title": "SpillAmountZScore",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "DataVolumeZScore",
                  "type": "float",
                  "displayAs": "number",
                  "order": 7,
                  "title": "DataVolumeZScore",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "warehouse_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 8,
                  "title": "warehouse_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "TotalUsedTimeInWarehouse",
                  "type": "float",
                  "displayAs": "number",
                  "order": 27,
                  "title": "TotalUsedTimeInWarehouse",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "TotalStatementTextTimeUsed",
                  "type": "float",
                  "displayAs": "number",
                  "order": 28,
                  "title": "TotalStatementTextTimeUsed",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "ProportionOfWarehouseTimeUsedByQuery",
                  "type": "float",
                  "displayAs": "number",
                  "order": 29,
                  "title": "ProportionOfWarehouseTimeUsedByQuery",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgQueryRuntime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 30,
                  "title": "WarehouseAvgQueryRuntime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgQueueTime",
                  "type": "float",
                  "displayAs": "number",
                  "order": 31,
                  "title": "WarehouseAvgQueueTime",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgProportionTimeQueueing",
                  "type": "float",
                  "displayAs": "number",
                  "order": 32,
                  "title": "WarehouseAvgProportionTimeQueueing",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgReadDataInGBPerQuery",
                  "type": "float",
                  "displayAs": "number",
                  "order": 38,
                  "title": "WarehouseAvgReadDataInGBPerQuery",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseStdReadDataInGBPerQuery",
                  "type": "float",
                  "displayAs": "number",
                  "order": 39,
                  "title": "WarehouseStdReadDataInGBPerQuery",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgDeltaCachePercent",
                  "type": "float",
                  "displayAs": "number",
                  "order": 40,
                  "title": "WarehouseAvgDeltaCachePercent",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseStdDeltaCachePercent",
                  "type": "float",
                  "displayAs": "number",
                  "order": 41,
                  "title": "WarehouseStdDeltaCachePercent",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgDiskSpillAmount",
                  "type": "float",
                  "displayAs": "number",
                  "order": 42,
                  "title": "WarehouseAvgDiskSpillAmount",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseStdDiskSpillAmount",
                  "type": "float",
                  "displayAs": "number",
                  "order": 43,
                  "title": "WarehouseStdDiskSpillAmount",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "WarehouseAvgQueryEfficiencyRatio",
                  "type": "float",
                  "displayAs": "number",
                  "order": 44,
                  "title": "WarehouseAvgQueryEfficiencyRatio",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_HasSpillFlag",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 47,
                  "title": "Calc_HasSpillFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_ReadDataFlag",
                  "type": "decimal",
                  "displayAs": "number",
                  "order": 48,
                  "title": "Calc_ReadDataFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_UsedWorkerTasksFlag",
                  "type": "decimal",
                  "displayAs": "number",
                  "order": 49,
                  "title": "Calc_UsedWorkerTasksFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_LongRunningQueryFlag",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 50,
                  "title": "Calc_LongRunningQueryFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Calc_HighDataVolumeFlag",
                  "type": "integer",
                  "displayAs": "number",
                  "order": 53,
                  "title": "Calc_HighDataVolumeFlag",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Total_Warehouse_Period_Dollars",
                  "type": "float",
                  "displayAs": "number",
                  "order": 54,
                  "title": "Total_Warehouse_Period_Dollars",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryRuntime_P50",
                  "type": "float",
                  "displayAs": "number",
                  "order": 55,
                  "title": "QueryRuntime_P50",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryRuntime_P90",
                  "type": "float",
                  "displayAs": "number",
                  "order": 56,
                  "title": "QueryRuntime_P90",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryRuntime_P95",
                  "type": "float",
                  "displayAs": "number",
                  "order": 57,
                  "title": "QueryRuntime_P95",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryRuntime_P99",
                  "type": "float",
                  "displayAs": "number",
                  "order": 58,
                  "title": "QueryRuntime_P99",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryQueueTime_P50",
                  "type": "float",
                  "displayAs": "number",
                  "order": 59,
                  "title": "QueryQueueTime_P50",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryQueueTime_P90",
                  "type": "float",
                  "displayAs": "number",
                  "order": 60,
                  "title": "QueryQueueTime_P90",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryQueueTime_P95",
                  "type": "float",
                  "displayAs": "number",
                  "order": 61,
                  "title": "QueryQueueTime_P95",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "numberFormat": "0.00",
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "QueryQueueTime_P99",
                  "type": "float",
                  "displayAs": "number",
                  "order": 62,
                  "title": "QueryQueueTime_P99",
                  "allowSearch": false,
                  "alignContent": "right",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "error_message",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100006,
                  "title": "error_message",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "dbt_metadata_json",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100038,
                  "title": "dbt_metadata_json",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "app",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100049,
                  "title": "app",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "node_id",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100050,
                  "title": "node_id",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "profile_name",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100051,
                  "title": "profile_name",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "target_name",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100052,
                  "title": "target_name",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "dbt_version",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100053,
                  "title": "dbt_version",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "dbt_databricks_version",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100054,
                  "title": "dbt_databricks_version",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "parsed_dbt_comment",
                  "type": "complex",
                  "displayAs": "json",
                  "order": 100055,
                  "title": "parsed_dbt_comment",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "DBT_Query_Type",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100056,
                  "title": "DBT_Query_Type",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "Selected_DBT_Attribute_Value",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100069,
                  "title": "Selected_DBT_Attribute_Value",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                },
                {
                  "booleanValues": [
                    "false",
                    "true"
                  ],
                  "imageUrlTemplate": "{{ @ }}",
                  "imageTitleTemplate": "{{ @ }}",
                  "imageWidth": "",
                  "imageHeight": "",
                  "linkUrlTemplate": "{{ @ }}",
                  "linkTextTemplate": "{{ @ }}",
                  "linkTitleTemplate": "{{ @ }}",
                  "linkOpenInNewTab": true,
                  "name": "client_application",
                  "type": "string",
                  "displayAs": "string",
                  "order": 100006,
                  "title": "client_application",
                  "allowSearch": false,
                  "alignContent": "left",
                  "allowHTML": false,
                  "highlightLinks": false,
                  "useMonospaceFont": false,
                  "preserveWhitespace": false
                }
              ],
              "allowHTMLByDefault": false,
              "itemsPerPage": 25,
              "paginationSize": "default",
              "condensed": true,
              "withRowNumber": false,
              "frame": {
                "showTitle": true,
                "showDescription": true,
                "title": "Query Efficiency Detail",
                "description": "Table-level detailed view of query efficiency along with flags (green = succeed query, red = failed query)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 97,
            "width": 6,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "aa90f64c",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_DBT_Query_Type",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "DBT_Query_Type",
                      "expression": "`DBT_Query_Type`"
                    },
                    {
                      "name": "DBT_Query_Type_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "DBT_Query_Type",
                    "displayName": "DBT_Query_Type",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_DBT_Query_Type"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "DBT Query Type"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 38,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "abfe6248",
            "queries": [
              {
                "name": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_executed_by",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "executed_by",
                      "expression": "`executed_by`"
                    },
                    {
                      "name": "executed_by_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "executed_by",
                    "displayName": "executed_by",
                    "queryName": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_executed_by"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Executed By"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 36,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "b6bafc57",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_warehouse_id",
                "query": {
                  "datasetName": "4bf19021",
                  "parameters": [
                    {
                      "name": "warehouse_id",
                      "keyword": "warehouse_id"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "warehouse_id",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeb8e0410169c9097a20230c52b0d_warehouse_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Id"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 106,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "c5b626da",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "84491e8e",
                  "fields": [
                    {
                      "name": "NumberOfClustersOn",
                      "expression": "`NumberOfClustersOn`"
                    },
                    {
                      "name": "countdistinct(event_minute)",
                      "expression": "COUNT(DISTINCT `event_minute`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "NumberOfClustersOn",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "# Clusters "
                },
                "y": {
                  "fieldName": "countdistinct(event_minute)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Num Minutes On N Clusters"
                  },
                  "displayName": "# Minutes On Cluster N"
                },
                "color": {
                  "fieldName": "NumberOfClustersOn",
                  "scale": {
                    "type": "quantitative",
                    "colorRamp": {
                      "mode": "scheme",
                      "scheme": "greenblue"
                    }
                  },
                  "displayName": "# Scaled Clusters"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Scaling Pattern Histogram"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 23,
            "width": 4,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "c7976e3b",
            "textbox_spec": "## Section 4 - Query Resource Allocation Advisor\n-----"
          },
          "position": {
            "x": 0,
            "y": 105,
            "width": 6,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "c8065778",
            "queries": [
              {
                "name": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacad13e14ae90b902c6c8537ea0_warehouse_id",
                "query": {
                  "datasetName": "a50512a8",
                  "parameters": [
                    {
                      "name": "warehouse_id",
                      "keyword": "warehouse_id"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "warehouse_id",
                    "queryName": "parameter_dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eeeacad13e14ae90b902c6c8537ea0_warehouse_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Id"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 4,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "cc8974b1",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a50512a8",
                  "fields": [
                    {
                      "name": "HighIncreaseFlag",
                      "expression": "`HighIncreaseFlag`"
                    },
                    {
                      "name": "sum(p24h_change_percentage)",
                      "expression": "SUM(`p24h_change_percentage`)"
                    },
                    {
                      "name": "usage_hour",
                      "expression": "`usage_hour`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "usage_hour",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Usage Hour"
                  },
                  "displayName": "Usage Hour"
                },
                "y": {
                  "fieldName": "sum(p24h_change_percentage)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "12 Hour Moving Average PoP"
                  },
                  "displayName": "12 Hour Moving Average PoP"
                },
                "color": {
                  "fieldName": "HighIncreaseFlag",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": 1,
                        "color": "#FF3621"
                      },
                      {
                        "value": 0,
                        "color": "#2672cb"
                      },
                      {
                        "value": "High Momentum",
                        "color": "#FF3621"
                      },
                      {
                        "value": "Within Range",
                        "color": "#2672cb"
                      }
                    ]
                  },
                  "legend": {
                    "title": "Has High Increase?",
                    "position": "bottom"
                  },
                  "displayName": "Has High Increase?"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Momentum Alert Indicator",
                "showDescription": true,
                "description": "Popular Alerting Mechanism for identifying when warehouse usage (24 hour rolling) increase X%"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 13,
            "width": 6,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "cd03bd01",
            "queries": [
              {
                "name": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_LongRunningQueryFlag",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "LongRunningQueryFlag",
                      "expression": "`LongRunningQueryFlag`"
                    },
                    {
                      "name": "LongRunningQueryFlag_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "LongRunningQueryFlag",
                    "displayName": "LongRunningQueryFlag",
                    "queryName": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_LongRunningQueryFlag"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Long Query Flag"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 83,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "d202bbc6",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a50512a8",
                  "fields": [
                    {
                      "name": "hourly(usage_hour)",
                      "expression": "DATE_TRUNC(\"HOUR\", `usage_hour`)"
                    },
                    {
                      "name": "sum(UsageDBUs)",
                      "expression": "SUM(`UsageDBUs`)"
                    },
                    {
                      "name": "sum(UsageDollars)",
                      "expression": "SUM(`UsageDollars`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "hourly(usage_hour)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Usage Hour"
                  },
                  "displayName": "Usage Hour"
                },
                "y": {
                  "scale": {
                    "type": "quantitative"
                  },
                  "fields": [
                    {
                      "fieldName": "sum(UsageDollars)",
                      "displayName": "Usage $ DBUs"
                    },
                    {
                      "fieldName": "sum(UsageDBUs)",
                      "displayName": "Usage DBUs"
                    }
                  ],
                  "axis": {
                    "title": "Usage Amount ($ or DBUs"
                  }
                },
                "color": {
                  "legend": {
                    "title": "Usage Type",
                    "position": "bottom"
                  }
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Warehouse Billing Over Time"
              },
              "mark": {
                "colors": [
                  "#00A972",
                  "#2672cb",
                  "#00A972",
                  "#FF3621",
                  "#8BCAE7",
                  "#AB4057",
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ],
                "layout": "group"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 6,
            "width": 6,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "d848fc0d",
            "textbox_spec": "# DBSQL Warehouse Advisor - DBT Version\n-----\nThis dashboard is a focused version of the warehouse advisor that embeds the understand of DBT related metadata tags. It enables users to monitor their warehouse and aggregate insight by the metadata DBT provides in its queries. \n\n### \n## Sections\n1. Warehouse General Intel - show basic billing usage and cost metrics for a warehouse (dbus, $, over time)\n2. Warehouse Scaling Intel - shows basic scaling metrics per warehouse (scaling history, avg scale (weighted))\n3. Query Tuning Advisor - Show common query history metrics such as runtime, queue time, failure rate, cache %, etc., identify inefficient queries with skew/spill indicators\n4. Query Statement Level Resource Allocation Advisor - Identify and allocate warehouse total used time by statement and query (optionally include and aggregate by TAG)\n"
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "d9ed6aaf",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    },
                    {
                      "name": "sum(AllocatedQueryCostByTime)",
                      "expression": "SUM(`AllocatedQueryCostByTime`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(AllocatedQueryCostByTime)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Total Allocated Cost By User ($)"
                  },
                  "displayName": "Query $ Allocated Cost"
                },
                "color": {
                  "fieldName": "profile_name",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "profile_name"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showDescription": true,
                "description": "Allocated Query Cost By Profile"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 75,
            "width": 2,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "da3a8225",
            "queries": [
              {
                "name": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_statement_type",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "statement_type",
                      "expression": "`statement_type`"
                    },
                    {
                      "name": "statement_type_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "statement_type",
                    "displayName": "statement_type",
                    "queryName": "dashboards/01eee4980f461d848d978ef2b00c7f1a/datasets/01eee49819aa10ef846adf03db1ca1e8_statement_type"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Statement Type"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 36,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "daec5b24",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(AllocatedQueryCostByTime)",
                      "expression": "AVG(`AllocatedQueryCostByTime`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "combo",
              "encodings": {
                "y": {
                  "primary": {
                    "fields": [
                      {
                        "fieldName": "avg(AllocatedQueryCostByTime)",
                        "displayName": "Avg Cost Per Query"
                      }
                    ]
                  },
                  "secondary": {
                    "fields": []
                  },
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "title": "Avg Cost Per Query ($)"
                  }
                },
                "color": {
                  "legend": {
                    "position": "bottom"
                  }
                },
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                }
              },
              "mark": {
                "colors": [
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Cost Per Query Over Time"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 70,
            "width": 4,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "e446f6a2",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_HighDataVolumeFlag",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "HighDataVolumeFlag",
                      "expression": "`HighDataVolumeFlag`"
                    },
                    {
                      "name": "HighDataVolumeFlag_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "HighDataVolumeFlag",
                    "displayName": "HighDataVolumeFlag",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_HighDataVolumeFlag"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "High Data Volume Flag"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 83,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "eae8e29e",
            "queries": [
              {
                "name": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_execution_status",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "execution_status",
                      "expression": "`execution_status`"
                    },
                    {
                      "name": "execution_status_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-multi-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "execution_status",
                    "displayName": "execution_status",
                    "queryName": "dashboards/01eeede2afd31b7fa86213faa888e038/datasets/01eeede2afdd1233bb67746087215eda_execution_status"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Query Status"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 36,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "ec5e9dda",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    },
                    {
                      "name": "statement_type",
                      "expression": "`statement_type`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "area",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fieldName": "count(*)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "Query Count"
                },
                "color": {
                  "fieldName": "statement_type",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "Statement Type",
                  "legend": {
                    "position": "bottom"
                  }
                },
                "label": {
                  "show": false
                }
              },
              "frame": {
                "showDescription": false,
                "description": "Query Count By Statement Type Over Time",
                "showTitle": true,
                "title": "Queries By Statement Type Over Time"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 60,
            "width": 3,
            "height": 5
          }
        },
        {
          "widget": {
            "name": "f3f6fe96",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(QueryRuntimeSeconds)",
                      "expression": "AVG(`QueryRuntimeSeconds`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    },
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fieldName": "avg(QueryRuntimeSeconds)",
                  "scale": {
                    "type": "quantitative",
                    "domain": {
                      "min": 0
                    }
                  },
                  "displayName": "Average QueryRuntimeSeconds"
                },
                "color": {
                  "fieldName": "profile_name",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "None",
                        "color": "#00A972"
                      }
                    ]
                  },
                  "legend": {
                    "position": "bottom"
                  },
                  "displayName": "profile_name"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Query Runtime Trends (by DBT Profile)"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 42,
            "width": 4,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "f46c9716",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "avg(QueueQueryTime)",
                      "expression": "AVG(`QueueQueryTime`)"
                    },
                    {
                      "name": "hourly(start_time)",
                      "expression": "DATE_TRUNC(\"HOUR\", `start_time`)"
                    },
                    {
                      "name": "max(WarehouseAvgQueueTime)",
                      "expression": "MAX(`WarehouseAvgQueueTime`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "hourly(start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "title": "Start Time"
                  },
                  "displayName": "Start Time"
                },
                "y": {
                  "fields": [
                    {
                      "fieldName": "avg(QueueQueryTime)",
                      "displayName": "Avg Query Queue Time (s)"
                    },
                    {
                      "fieldName": "max(WarehouseAvgQueueTime)",
                      "displayName": "Warehouse Average Queue Time (s)"
                    }
                  ],
                  "scale": {
                    "type": "quantitative"
                  }
                },
                "color": {
                  "legend": {
                    "position": "bottom"
                  }
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Queue Time Trends"
              },
              "mark": {
                "colors": [
                  "#2672cb",
                  "#919191",
                  "#00A972",
                  "#FF3621",
                  "#8BCAE7",
                  "#AB4057",
                  "#99DDB4",
                  "#FCA4A1",
                  "#919191",
                  "#BF7080"
                ]
              }
            }
          },
          "position": {
            "x": 0,
            "y": 48,
            "width": 4,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "f982b922",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "9275d56b",
                  "fields": [
                    {
                      "name": "count(*)",
                      "expression": "COUNT(`*`)"
                    },
                    {
                      "name": "error_message",
                      "expression": "`error_message`"
                    },
                    {
                      "name": "profile_name",
                      "expression": "`profile_name`"
                    },
                    {
                      "name": "target_name",
                      "expression": "`target_name`"
                    }
                  ],
                  "disaggregated": false,
                  "orders": [
                    {
                      "direction": "ASC",
                      "expression": "`error_message`"
                    },
                    {
                      "direction": "ASC",
                      "expression": "`profile_name`"
                    },
                    {
                      "direction": "ASC",
                      "expression": "`target_name`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pivot",
              "encodings": {
                "rows": [
                  {
                    "fieldName": "error_message",
                    "displayName": "Error Message"
                  }
                ],
                "columns": [
                  {
                    "fieldName": "profile_name",
                    "displayName": "profile_name"
                  },
                  {
                    "fieldName": "target_name",
                    "displayName": "target_name"
                  }
                ],
                "cell": {
                  "fieldName": "count(*)",
                  "cellType": "text",
                  "displayName": "Count of Records"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Error Messsage Frequency By DBT Target and Profile",
                "showDescription": true,
                "description": "Number of Query Runs by Profile >> Target"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 65,
            "width": 2,
            "height": 10
          }
        }
      ]
    }
  ]
}