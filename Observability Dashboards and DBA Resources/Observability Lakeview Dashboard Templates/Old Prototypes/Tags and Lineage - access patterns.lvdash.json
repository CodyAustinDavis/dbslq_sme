{"datasets":[{"name":"f004d4c4","displayName":"column_accesses_by_tag_person_and_type","query":"SELECT\n concat(catalog_name, '.', schema_name, '.', table_name, '.', column_name) as full_name,\n mask(created_by) as accessed_by,\n COUNT(distinct event_time) as access_count,\n entity_type,\n MIN(event_date) as first_access_date,\n MAX(event_date) as last_access_date\nFROM\n system.access.column_lineage\n JOIN pdavis.dbsql_blog.uc_tags\n ON source_table_catalog = catalog_name\n AND source_table_schema = schema_name\n AND source_table_name = table_name\n AND source_column_name = column_name\n AND object_type = 'column'\nWHERE\n event_date BETWEEN :start_date AND :end_date\n  AND     (\n      lcase(tag_name) like concat('%', lcase(:tag_parameter),'%')\n      OR lcase(tag_value) like concat('%', lcase(:tag_parameter),'%')\n    )\nand entity_type is not null\nGROUP BY\n ALL\nORDER BY\n access_count desc","parameters":[{"displayName":"start_date","keyword":"start_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-90d/d"}]}}},{"displayName":"end_date","keyword":"end_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}},{"displayName":"tag_parameter","keyword":"tag_parameter","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pii"}]}}}]},{"name":"f5bd8d07","displayName":"tag_name_permutations","query":"select \nCASE WHEN tag_name = '' THEN 'blank' ELSE tag_name END as tag_name\n, CASE WHEN tag_value = '' THEN 'blank' ELSE tag_value END as tag_value\n, count(*) as total from pdavis.dbsql_blog.uc_tags\nwhere     (\n      lcase(tag_name) like concat('%', lcase(:tag_parameter),'%')\n      OR lcase(tag_value) like concat('%', lcase(:tag_parameter),'%')\n    )\ngroup by all","parameters":[{"displayName":"tag_parameter","keyword":"tag_parameter","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pii"}]}}}]},{"name":"11f43774","displayName":"objects_with_tag","query":"select \nCOUNT(*) FILTER (WHERE object_type = 'catalog') as catalog_count,\nCOUNT(*) FILTER (WHERE object_type = 'schema') as schema_count,\nCOUNT(*) FILTER (WHERE object_type = 'table') as table_count,\nCOUNT(*) FILTER (WHERE object_type = 'column') as column_count\nfrom pdavis.dbsql_blog.uc_tags\nwhere     \n    (\n      lcase(tag_name) like concat('%', lcase(:tag_parameter),'%')\n      OR lcase(tag_value) like concat('%', lcase(:tag_parameter),'%')\n    )\n","parameters":[{"displayName":"tag_parameter","keyword":"tag_parameter","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pii"}]}}}]},{"name":"53b58869","displayName":"catalogs with tag","query":"select \ncatalog_name as catalog_name\nfrom pdavis.dbsql_blog.uc_tags\nwhere     \n    (\n      lcase(tag_name) like concat('%', lcase(:tag_parameter),'%')\n      OR lcase(tag_value) like concat('%', lcase(:tag_parameter),'%')\n    )\n    AND object_type = 'catalog'","parameters":[{"displayName":"tag_parameter","keyword":"tag_parameter","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pii"}]}}}]},{"name":"bed4c290","displayName":"schemas with tag","query":"select \nconcat(catalog_name, '.', schema_name) as schema_name\nfrom pdavis.dbsql_blog.uc_tags\nwhere     \n    (\n      lcase(tag_name) like concat('%', lcase(:tag_parameter),'%')\n      OR lcase(tag_value) like concat('%', lcase(:tag_parameter),'%')\n    )\n    AND object_type = 'schema'","parameters":[{"displayName":"tag_parameter","keyword":"tag_parameter","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pii"}]}}}]},{"name":"8d39a777","displayName":"tables with tag","query":"select \nconcat(catalog_name, '.', schema_name, '.', table_name) as table_name\nfrom pdavis.dbsql_blog.uc_tags\nwhere     \n    (\n      lcase(tag_name) like concat('%', lcase(:tag_parameter),'%')\n      OR lcase(tag_value) like concat('%', lcase(:tag_parameter),'%')\n    )\n    AND object_type = 'table'","parameters":[{"displayName":"tag_parameter","keyword":"tag_parameter","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pii"}]}}}]},{"name":"ae5003d7","displayName":"columns with tag","query":"select \nconcat(catalog_name, '.', schema_name, '.', table_name, '.', column_name) as column_name\nfrom pdavis.dbsql_blog.uc_tags\nwhere     \n    (\n      lcase(tag_name) like concat('%', lcase(:tag_parameter),'%')\n      OR lcase(tag_value) like concat('%', lcase(:tag_parameter),'%')\n    )\n    AND object_type = 'column'","parameters":[{"displayName":"tag_parameter","keyword":"tag_parameter","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"pii"}]}}}]}],"pages":[{"name":"b56df941","displayName":"New Page","layout":[{"widget":{"name":"f80ebc01","queries":[{"name":"main_query","query":{"datasetName":"f004d4c4","fields":[{"name":"full_name","expression":"`full_name`"},{"name":"entity_type","expression":"`entity_type`"},{"name":"accessed_by","expression":"`accessed_by`"},{"name":"access_count","expression":"`access_count`"},{"name":"first_access_date","expression":"`first_access_date`"},{"name":"last_access_date","expression":"`last_access_date`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"full_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":0,"title":"full_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"full_name"},{"fieldName":"entity_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":1,"title":"entity_type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"entity_type"},{"fieldName":"accessed_by","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":2,"title":"accessed_by","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"accessed_by"},{"fieldName":"access_count","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":3,"title":"access_count","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"access_count"},{"fieldName":"first_access_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":4,"title":"first_access_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"first_access_date"},{"fieldName":"last_access_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":5,"title":"last_access_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"last_access_date"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"showTitle":true,"title":"Column accesses by Person and Type","showDescription":false,"description":""}}},"position":{"x":0,"y":17,"width":6,"height":4}},{"widget":{"name":"1bbef063","queries":[{"name":"main_query","query":{"datasetName":"f5bd8d07","fields":[{"name":"sum(total)","expression":"SUM(`total`)"},{"name":"tag_value","expression":"`tag_value`"},{"name":"tag_name","expression":"`tag_name`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"heatmap","encodings":{"x":{"fieldName":"tag_value","scale":{"type":"categorical"},"displayName":"tag_value"},"y":{"fieldName":"tag_name","scale":{"type":"categorical"},"displayName":"tag_name"},"color":{"fieldName":"sum(total)","scale":{"type":"quantitative"},"displayName":"Sum of total"}},"frame":{"title":"Tag and value permutations","showTitle":true,"showDescription":false}}},"position":{"x":0,"y":2,"width":6,"height":6}},{"widget":{"name":"2b8e4f60","queries":[{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e2921aa1a6dd423c545454c0_tag_parameter","query":{"datasetName":"11f43774","parameters":[{"name":"tag_parameter","keyword":"tag_parameter"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28b1743a88fffd7bbef0779_tag_parameter","query":{"datasetName":"f004d4c4","parameters":[{"name":"tag_parameter","keyword":"tag_parameter"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28f104393c831078515976a_tag_parameter","query":{"datasetName":"f5bd8d07","parameters":[{"name":"tag_parameter","keyword":"tag_parameter"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7a47b414b699d77eb38c39df16_tag_parameter","query":{"datasetName":"53b58869","parameters":[{"name":"tag_parameter","keyword":"tag_parameter"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7d1d5011d4ac260bd60e4de5ef_tag_parameter","query":{"datasetName":"bed4c290","parameters":[{"name":"tag_parameter","keyword":"tag_parameter"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7d5cbd17b697032f9d4768a221_tag_parameter","query":{"datasetName":"8d39a777","parameters":[{"name":"tag_parameter","keyword":"tag_parameter"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7d5d0c1314a17607f053c52a4e_tag_parameter","query":{"datasetName":"ae5003d7","parameters":[{"name":"tag_parameter","keyword":"tag_parameter"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"tag_parameter","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e2921aa1a6dd423c545454c0_tag_parameter"},{"parameterName":"tag_parameter","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28b1743a88fffd7bbef0779_tag_parameter"},{"parameterName":"tag_parameter","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28f104393c831078515976a_tag_parameter"},{"parameterName":"tag_parameter","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7a47b414b699d77eb38c39df16_tag_parameter"},{"parameterName":"tag_parameter","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7d1d5011d4ac260bd60e4de5ef_tag_parameter"},{"parameterName":"tag_parameter","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7d5cbd17b697032f9d4768a221_tag_parameter"},{"parameterName":"tag_parameter","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3d7d5d0c1314a17607f053c52a4e_tag_parameter"}]},"frame":{"showTitle":true,"title":"Enter the tag*"}}},"position":{"x":0,"y":0,"width":2,"height":2}},{"widget":{"name":"9462f4f7","queries":[{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28b1743a88fffd7bbef0779_start_date","query":{"datasetName":"f004d4c4","parameters":[{"name":"start_date","keyword":"start_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-picker","encodings":{"fields":[{"parameterName":"start_date","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28b1743a88fffd7bbef0779_start_date"}]},"frame":{"showTitle":true,"title":"Start Date"}}},"position":{"x":2,"y":0,"width":2,"height":2}},{"widget":{"name":"b35f2b8b","queries":[{"name":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28b1743a88fffd7bbef0779_end_date","query":{"datasetName":"f004d4c4","parameters":[{"name":"end_date","keyword":"end_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-picker","encodings":{"fields":[{"parameterName":"end_date","queryName":"parameter_dashboards/01ef3b29e28115f1844ea05aede4ff4c/datasets/01ef3b29e28b1743a88fffd7bbef0779_end_date"}]},"frame":{"showTitle":true,"title":"End Date"}}},"position":{"x":4,"y":0,"width":2,"height":2}},{"widget":{"name":"a9a086d4","textbox_spec":"*All tag names and values containing the entered tag are selected regardless of case and exclude values where the catalog = '_databricks_internal'.  To change, simply edit the where clauses in the data tab."},"position":{"x":0,"y":21,"width":6,"height":2}},{"widget":{"name":"bb1a8456","queries":[{"name":"main_query","query":{"datasetName":"f004d4c4","fields":[{"name":"monthly(last_access_date)","expression":"DATE_TRUNC(\"MONTH\", `last_access_date`)"},{"name":"sum(access_count)","expression":"SUM(`access_count`)"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"line","encodings":{"x":{"fieldName":"monthly(last_access_date)","scale":{"type":"temporal"},"displayName":"last_access_date"},"y":{"fieldName":"sum(access_count)","scale":{"type":"quantitative"},"displayName":"Sum of access_count"}},"frame":{"showTitle":true,"title":"Columns with Tag accesses"}}},"position":{"x":3,"y":8,"width":3,"height":5}},{"widget":{"name":"67f78e93","queries":[{"name":"main_query","query":{"datasetName":"53b58869","fields":[{"name":"catalog_name","expression":"`catalog_name`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"catalog_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"catalog_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"catalog_name"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":true,"frame":{"showTitle":true,"title":"Catalogs with tag"}}},"position":{"x":0,"y":13,"width":2,"height":4}},{"widget":{"name":"1aa737b5","queries":[{"name":"main_query","query":{"datasetName":"bed4c290","fields":[{"name":"schema_name","expression":"`schema_name`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"schema_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"schema_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"schema_name"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":true,"frame":{"showTitle":true,"title":"Schemas with tag"}}},"position":{"x":2,"y":13,"width":2,"height":4}},{"widget":{"name":"2b1de8af","queries":[{"name":"main_query","query":{"datasetName":"8d39a777","fields":[{"name":"table_name","expression":"`table_name`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"table_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"table_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"table_name"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":true,"frame":{"showTitle":true,"title":"Tables with tag"}}},"position":{"x":4,"y":13,"width":2,"height":4}},{"widget":{"name":"81fe9289","queries":[{"name":"main_query","query":{"datasetName":"ae5003d7","fields":[{"name":"column_name","expression":"`column_name`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"column_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"column_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"column_name"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":true,"frame":{"showTitle":true,"title":"Columns with tag"}}},"position":{"x":0,"y":8,"width":3,"height":5}}]}]}