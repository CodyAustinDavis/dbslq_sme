{"datasets":[{"name":"7fd391ae","displayName":"column_accesses_by_person_and_type","query":"SELECT\n mask(created_by) as created_by,\n entity_type,\n COUNT(distinct event_time) as access_count,\n MIN(event_date) as first_access_date,\n MAX(event_date) as last_access_date\nFROM\n system.access.column_lineage\nWHERE\nsource_column_name = split_part(:table_full_name_val, '.', 4)\nAND source_table_full_name = concat(\n    split_part(:table_full_name_val,'.' ,1 ), '.',\n    split_part(:table_full_name_val,'.' ,2 ), '.',\n    split_part(:table_full_name_val,'.' ,3 )\n    )\n AND event_date BETWEEN :start_date AND :end_date\nand entity_type is not null\nGROUP BY\n ALL\nORDER BY\n access_count desc","parameters":[{"displayName":"start_date","keyword":"start_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-90d/d"}]}}},{"displayName":"end_date","keyword":"end_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}},{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.billing.usage.usage_quantity"}]}}}]},{"name":"9349afc7","displayName":"column_accesses_by_date","query":"WITH column_access_by_date AS (\n    SELECT\n    entity_type,\n    event_date,\n    COUNT(*) AS frequency\n    FROM\n    system.access.column_lineage\n    WHERE\n    1 = 1\n    AND source_column_name = split_part(:table_full_name_val, '.', 4)\n    AND source_table_full_name = concat(\n        split_part(:table_full_name_val,'.' ,1 ), '.',\n        split_part(:table_full_name_val,'.' ,2 ), '.',\n        split_part(:table_full_name_val,'.' ,3 )\n        )\n    AND event_date BETWEEN :start_date AND :end_date    \n    GROUP BY\n    ALL\n    ORDER BY\n    frequency DESC\n)\nselect * from column_access_by_date","parameters":[{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.billing.usage.usage_quantity"}]}}},{"displayName":"start_date","keyword":"start_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-90d/d"}]}}},{"displayName":"end_date","keyword":"end_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}}]},{"name":"b8597633","displayName":"similarly_named_columns","query":"-- get all current columns matching the name of the selected column and their table names\nWITH current_columns AS (\n    select\n      column_name,\n      concat(\n        table_catalog,'.',table_schema,'.',table_name\n      ) as table_full_name\n    from\n      system.information_schema.columns\n    where\n      column_name = split_part(:table_full_name_val, '.', 4)\n  ),\n-- add context for how current columns are used - this is to gauge frequency of usage on the \n-- similarly named data product\ncolumn_usage AS (\n    SELECT\n      cc.table_full_name, \n      cc.column_name,\n      count(*) as access_count,\n      max(event_date) as last_access_date\n    FROM\n      current_columns cc\n      LEFT JOIN \n        system.access.column_lineage cl \n        ON \n        cl.source_table_full_name = cc.table_full_name\n        AND cl.source_column_name = cc.column_name\n      group by all\n      order by access_count desc\n)\nSELECT * FROM column_usage","parameters":[{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.billing.usage.usage_quantity"}]}}}]},{"name":"69b7de8f","displayName":"downstream_column_usage","query":"WITH column_usage AS (\n    SELECT\n    target_column_name,\n    target_table_full_name,\n    max(event_date) as last_event_date,\n    COUNT(*) AS frequency\n    FROM\n    system.access.column_lineage\n    WHERE\n    1 = 1\n    AND source_column_name = split_part(:table_full_name_val, '.', 4)\n    AND source_table_full_name = concat(\n        split_part(:table_full_name_val,'.' ,1 ), '.',\n        split_part(:table_full_name_val,'.' ,2 ), '.',\n        split_part(:table_full_name_val,'.' ,3 )\n        )\n    AND event_date BETWEEN :start_date AND :end_date    \n    GROUP BY\n    target_column_name,\n    target_table_full_name\n    ORDER BY\n    frequency DESC\n)\nselect * from column_usage\n","parameters":[{"displayName":"table_full_name_val","keyword":"table_full_name_val","dataType":"STRING","defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.billing.usage.usage_quantity"}]}}},{"displayName":"start_date","keyword":"start_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now-14d/d"}]}}},{"displayName":"end_date","keyword":"end_date","dataType":"DATE","defaultSelection":{"values":{"dataType":"DATE","values":[{"value":"now/d"}]}}}]},{"name":"14753b11","displayName":"Untitled dataset","query":""}],"pages":[{"name":"759af60d","displayName":"New Page","layout":[{"widget":{"name":"297ff7ca","queries":[{"name":"main_query","query":{"datasetName":"7fd391ae","fields":[{"name":"created_by","expression":"`created_by`"},{"name":"entity_type","expression":"`entity_type`"},{"name":"access_count","expression":"`access_count`"},{"name":"first_access_date","expression":"`first_access_date`"},{"name":"last_access_date","expression":"`last_access_date`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"created_by","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"created_by","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"created_by"},{"fieldName":"entity_type","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100001,"title":"entity_type","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"entity_type"},{"fieldName":"access_count","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":100003,"title":"access_count","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"access_count"},{"fieldName":"first_access_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":100004,"title":"first_access_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"first_access_date"},{"fieldName":"last_access_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":100005,"title":"last_access_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"last_access_date"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"showTitle":true,"title":"Column accesses by Person and Type","showDescription":false,"description":""}}},"position":{"x":0,"y":12,"width":6,"height":4}},{"widget":{"name":"daee7555","queries":[{"name":"main_query","query":{"datasetName":"9349afc7","fields":[{"name":"entity_type","expression":"`entity_type`"},{"name":"daily(event_date)","expression":"DATE_TRUNC(\"DAY\", `event_date`)"},{"name":"sum(frequency)","expression":"SUM(`frequency`)"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"daily(event_date)","scale":{"type":"temporal"},"displayName":"event_date"},"y":{"fieldName":"sum(frequency)","scale":{"type":"quantitative"},"displayName":"Sum of frequency"},"color":{"fieldName":"entity_type","scale":{"type":"categorical"},"displayName":"entity_type"},"label":{"show":false}},"frame":{"title":"Column Accesses by Date","showTitle":true,"showDescription":false}}},"position":{"x":2,"y":2,"width":4,"height":6}},{"widget":{"name":"3e68ef55","queries":[{"name":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088ed01d089c4e8d0803059aa2_table_full_name_val","query":{"datasetName":"7fd391ae","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088ed5148284969597a3d25a71_table_full_name_val","query":{"datasetName":"9349afc7","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088ed919c9bcc963adc5b86f94_table_full_name_val","query":{"datasetName":"b8597633","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088edd1fb0ac3fb74550a215da_table_full_name_val","query":{"datasetName":"69b7de8f","parameters":[{"name":"table_full_name_val","keyword":"table_full_name_val"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-single-select","encodings":{"fields":[{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088ed01d089c4e8d0803059aa2_table_full_name_val"},{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088ed5148284969597a3d25a71_table_full_name_val"},{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088ed919c9bcc963adc5b86f94_table_full_name_val"},{"parameterName":"table_full_name_val","queryName":"parameter_dashboards/01ef3b088ec417bd8e3d3a041d68aa9e/datasets/01ef3b088edd1fb0ac3fb74550a215da_table_full_name_val"}]},"selection":{"defaultSelection":{"values":{"dataType":"STRING","values":[{"value":"system.billing.usage.usage_quantity"}]}}},"frame":{"showTitle":true,"title":"Enter the 4 level column name "}}},"position":{"x":0,"y":0,"width":2,"height":2}},{"widget":{"name":"861420b0","queries":[{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef38ce00f9115399168140634dac37_start_date","query":{"datasetName":"7fd391ae","parameters":[{"name":"start_date","keyword":"start_date"}],"disaggregated":false}},{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_start_date","query":{"datasetName":"9349afc7","parameters":[{"name":"start_date","keyword":"start_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-picker","encodings":{"fields":[{"parameterName":"start_date","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef38ce00f9115399168140634dac37_start_date"},{"parameterName":"start_date","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_start_date"}]},"frame":{"showTitle":true,"title":"Start Date"}}},"position":{"x":2,"y":0,"width":2,"height":2}},{"widget":{"name":"81e5cb0d","queries":[{"name":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_end_date","query":{"datasetName":"9349afc7","parameters":[{"name":"end_date","keyword":"end_date"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"filter-date-picker","encodings":{"fields":[{"parameterName":"end_date","queryName":"parameter_dashboards/01ef33e6963e16d4b27c336f0d066536/datasets/01ef395328e410aabf879b1ffa7c1a0f_end_date"}]},"frame":{"showTitle":true,"title":"End Date"}}},"position":{"x":4,"y":0,"width":2,"height":2}},{"widget":{"name":"d89d8c05","queries":[{"name":"main_query","query":{"datasetName":"b8597633","fields":[{"name":"table_full_name","expression":"`table_full_name`"},{"name":"column_name","expression":"`column_name`"},{"name":"access_count","expression":"`access_count`"},{"name":"last_access_date","expression":"`last_access_date`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"table_full_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"table_full_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"table_full_name"},{"fieldName":"column_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100001,"title":"column_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"column_name"},{"fieldName":"access_count","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":100002,"title":"access_count","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"access_count"},{"fieldName":"last_access_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":100003,"title":"last_access_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"last_access_date"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"title":"Tables containing same named columns and reference counts","showTitle":true}}},"position":{"x":0,"y":16,"width":6,"height":4}},{"widget":{"name":"9c70e63b","textbox_spec":"Null entity and target types are included in this dashboard (e.g. queries from JDBC or UI clicks)"},"position":{"x":0,"y":20,"width":6,"height":1}},{"widget":{"name":"78ac3221","queries":[{"name":"main_query","query":{"datasetName":"69b7de8f","fields":[{"name":"target_column_name","expression":"`target_column_name`"},{"name":"target_table_full_name","expression":"`target_table_full_name`"},{"name":"frequency","expression":"`frequency`"},{"name":"last_event_date","expression":"`last_event_date`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"target_column_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":0,"title":"target_column_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"target_column_name"},{"fieldName":"target_table_full_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":1,"title":"target_table_full_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"target_table_full_name"},{"fieldName":"frequency","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":2,"title":"frequency","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"frequency"},{"fieldName":"last_event_date","dateTimeFormat":"yyyy-MM-DD","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"date","displayAs":"datetime","visible":true,"order":3,"title":"last_event_date","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"last_event_date"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"showTitle":true,"title":"Downstream Column usage","showDescription":false}}},"position":{"x":0,"y":8,"width":6,"height":4}},{"widget":{"name":"993f5872","queries":[{"name":"main_query","query":{"datasetName":"b8597633","fields":[{"name":"countdistinct(table_full_name)","expression":"COUNT(DISTINCT `table_full_name`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"countdistinct(table_full_name)","displayName":"Count of Unique table_full_name"}},"frame":{"showTitle":true,"title":"Tables with the same column name","showDescription":false,"description":""}}},"position":{"x":0,"y":2,"width":2,"height":2}},{"widget":{"name":"4d3595b5","queries":[{"name":"main_query","query":{"datasetName":"69b7de8f","fields":[{"name":"countdistinct(target_table_full_name)","expression":"COUNT(DISTINCT `target_table_full_name`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"countdistinct(target_table_full_name)","displayName":"Count of Unique target_table_full_name"}},"frame":{"showTitle":true,"title":"Downstream data objects"}}},"position":{"x":0,"y":4,"width":2,"height":2}},{"widget":{"name":"7add1cf4","queries":[{"name":"main_query","query":{"datasetName":"7fd391ae","fields":[{"name":"sum(access_count)","expression":"SUM(`access_count`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"sum(access_count)","displayName":"Sum of access_count"}},"frame":{"showTitle":true,"title":"Column Accesses"}}},"position":{"x":0,"y":6,"width":2,"height":2}}]}]}